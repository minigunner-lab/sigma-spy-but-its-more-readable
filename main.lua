local Configuration = {
	UseWorkspace = false, 
	NoActors = false,
	FolderName = "Sigma Spy",
	RepoUrl = "https://raw.githubusercontent.com/depthso/Sigma-Spy/refs/heads/main",
	ParserUrl = "https://github.com/depthso/Roblox-parser/raw/32eb8e3ca74a1210d74ed0c54479b5147647a0e4"
}

local Parameters = {...}
local Overwrites = Parameters[1]
if typeof(Overwrites) == "table" then
	for Key, Value in Overwrites do
		Configuration[Key] = Value
	end
end

local Services = setmetatable({}, {
	__index = function(self, Name: string): Instance
		local Service = game:GetService(Name)
		return cloneref(Service)
	end,
})

local Files = loadstring(game:HttpGet("https://raw.githubusercontent.com/depthso/Sigma-Spy/refs/heads/main/src/lib/Files.lua"))()
Files:PushConfig(Configuration)
Files:Init({
	Services = Services
})

local Folder = Files.FolderName
local Scripts = {
	Config = Files:GetModule(`{Folder}/Config`, "Config"),
	ReturnSpoofs = Files:GetModule(`{Folder}/Return spoofs`, "Return Spoofs"),
	Configuration = Configuration,
	Files = Files,
	Process = {"base64", "dHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglBcmdzOiB0YWJsZSwKICAgIElkOiBzdHJpbmcsCglNZXRob2Q6IHN0cmluZywKICAgIFRyYW5zZmVyVHlwZTogc3RyaW5nLAoJVmFsdWVSZXBsYWNlbWVudHM6IHRhYmxlLAogICAgUmV0dXJuVmFsdWVzOiB0YWJsZSwKICAgIE9yaWdpbmFsRnVuYzogKEluc3RhbmNlLCAuLi5hbnkpIC0+IC4uLmFueQp9CgotLS8vIE1vZHVsZQpsb2NhbCBQcm9jZXNzID0gewogICAgLS0vLyBSZW1vdGUgY2xhc3NlcwogICAgUmVtb3RlQ2xhc3NEYXRhID0gewogICAgICAgIFsiUmVtb3RlRXZlbnQiXSA9IHsKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJGaXJlU2VydmVyIiwKICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgUmVjZWl2ZSA9IHsKICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gewogICAgICAgICAgICBJc1JlbW90ZUZ1bmN0aW9uID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJJbnZva2VTZXJ2ZXIiLAogICAgICAgICAgICAgICAgImludm9rZVNlcnZlciIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFJlY2VpdmUgPSB7CiAgICAgICAgICAgICAgICAiT25DbGllbnRJbnZva2UiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIlVucmVsaWFibGVSZW1vdGVFdmVudCJdID0gewogICAgICAgICAgICBTZW5kID0gewogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLAogICAgICAgICAgICAgICAgImZpcmVTZXJ2ZXIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBSZWNlaXZlID0gewogICAgICAgICAgICAgICAgIk9uQ2xpZW50RXZlbnQiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIkJpbmRhYmxlRXZlbnQiXSA9IHsKICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJGaXJlIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgUmVjZWl2ZSA9IHsKICAgICAgICAgICAgICAgICJFdmVudCIsCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFsiQmluZGFibGVGdW5jdGlvbiJdID0gewogICAgICAgICAgICBJc1JlbW90ZUZ1bmN0aW9uID0gdHJ1ZSwKICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJJbnZva2UiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBSZWNlaXZlID0gewogICAgICAgICAgICAgICAgIk9uSW52b2tlIiwKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBSZW1vdGVPcHRpb25zID0ge30sCiAgICBMb29waW5nUmVtb3RlcyA9IHt9LAogICAgQ29uZmlnT3ZlcndyaXRlcyA9IHsKICAgICAgICBbeyJzaXJodXJ0IiwgInBvdGFzc2l1bSIsICJ3YXZlIn1dID0gewogICAgICAgICAgICBGb3JjZVVzZUN1c3RvbUNvbW0gPSB0cnVlCiAgICAgICAgfQogICAgfQp9CgotLS8vIE1vZHVsZXMKbG9jYWwgSG9vawpsb2NhbCBDb21tdW5pY2F0aW9uCmxvY2FsIFJldHVyblNwb29mcwpsb2NhbCBVaQpsb2NhbCBDb25maWcKCi0tLy8gQ29tbXVuaWNhdGlvbiBjaGFubmVsCmxvY2FsIENoYW5uZWwKbG9jYWwgQ2hhbm5lbFdyYXBwZWQgPSBmYWxzZQoKbG9jYWwgU2lnbWFFTlYgPSBnZXRmZW52KDEpCgpsb2NhbCBmdW5jdGlvbiBNZXJnZShCYXNlOiB0YWJsZSwgTmV3OiB0YWJsZSkKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIE5ldyBkbwoJCUJhc2VbS2V5XSA9IFZhbHVlCgllbmQKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkluaXQoRGF0YSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCiAgICAtLS8vIE1vZHVsZXMKICAgIENvbmZpZyA9IE1vZHVsZXMuQ29uZmlnCiAgICBVaSA9IE1vZHVsZXMuVWkKICAgIEhvb2sgPSBNb2R1bGVzLkhvb2sKICAgIENvbW11bmljYXRpb24gPSBNb2R1bGVzLkNvbW11bmljYXRpb24KICAgIFJldHVyblNwb29mcyA9IE1vZHVsZXMuUmV0dXJuU3Bvb2ZzCmVuZAoKLS0vLyBDb21tdW5pY2F0aW9uCmZ1bmN0aW9uIFByb2Nlc3M6U2V0Q2hhbm5lbChOZXdDaGFubmVsOiBCaW5kYWJsZUV2ZW50LCBJc1dyYXBwZWQ6IGJvb2xlYW4pCiAgICBDaGFubmVsID0gTmV3Q2hhbm5lbAogICAgQ2hhbm5lbFdyYXBwZWQgPSBJc1dyYXBwZWQKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkdldENvbmZpZ092ZXJ3cml0ZXMoTmFtZTogc3RyaW5nKQogICAgbG9jYWwgQ29uZmlnT3ZlcndyaXRlcyA9IHNlbGYuQ29uZmlnT3ZlcndyaXRlcwoKICAgIGZvciBMaXN0LCBPdmVyd3JpdGVzIGluIG5leHQsIENvbmZpZ092ZXJ3cml0ZXMgZG8KICAgICAgICBpZiBub3QgdGFibGUuZmluZChMaXN0LCBOYW1lKSB0aGVuIGNvbnRpbnVlIGVuZAogICAgICAgIHJldHVybiBPdmVyd3JpdGVzCiAgICBlbmQKICAgIHJldHVybgplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tDb25maWcoQ29uZmlnOiB0YWJsZSkKICAgIGxvY2FsIE5hbWUgPSBpZGVudGlmeWV4ZWN1dG9yKCk6bG93ZXIoKQoKICAgIC0tLy8gRm9yY2UgY29uZmlndXJhdGlvbiBvdmVyd3JpdGVzIGZvciBzcGVjaWZpYyBleGVjdXRvcnMKICAgIGxvY2FsIE92ZXJ3cml0ZXMgPSBzZWxmOkdldENvbmZpZ092ZXJ3cml0ZXMoTmFtZSkKICAgIGlmIG5vdCBPdmVyd3JpdGVzIHRoZW4gcmV0dXJuIGVuZAoKICAgIE1lcmdlKENvbmZpZywgT3ZlcndyaXRlcykKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNsZWFuQ0Vycm9yKEVycm9yOiBzdHJpbmcpOiBzdHJpbmcKICAgIEVycm9yID0gRXJyb3I6Z3N1YigiOiVkKzogIiwgIiIpCiAgICBFcnJvciA9IEVycm9yOmdzdWIoIiwgZ290ICVhKyIsICIiKQogICAgRXJyb3IgPSBFcnJvcjpnc3ViKCJpbnZhbGlkIGFyZ3VtZW50IiwgIm1pc3NpbmcgYXJndW1lbnQiKQogICAgcmV0dXJuIEVycm9yCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpEZWVwQ2xvbmVUYWJsZShUYWJsZSwgSWdub3JlOiB0YWJsZT8pCglsb2NhbCBOZXcgPSB7fQoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgVGFibGUgZG8KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSB2YWx1ZSBpcyBpZ25vcmVkCiAgICAgICAgaWYgSWdub3JlIGFuZCB0YWJsZS5maW5kKElnbm9yZSwgVmFsdWUpIHRoZW4gY29udGludWUgZW5kCgoJCU5ld1tLZXldID0gdHlwZW9mKFZhbHVlKSA9PSAidGFibGUiIGFuZCBzZWxmOkRlZXBDbG9uZVRhYmxlKFZhbHVlKSBvciBWYWx1ZQoJZW5kCglyZXR1cm4gTmV3CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpVbnBhY2soVGFibGU6IHRhYmxlKQoJbG9jYWwgTGVuZ3RoID0gdGFibGUubWF4bihUYWJsZSkKCXJldHVybiB1bnBhY2soVGFibGUsIDEsIExlbmd0aCkKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlB1c2hDb25maWcoT3ZlcndyaXRlcykKICAgIE1lcmdlKHNlbGYsIE92ZXJ3cml0ZXMpCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpGdW5jRXhpc3RzKE5hbWU6IHN0cmluZykKCXJldHVybiBnZXRmZW52KDEpW05hbWVdCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDaGVja0V4ZWN1dG9yKCk6IGJvb2xlYW4KICAgIGxvY2FsIEJsYWNrbGlzdGVkID0gewogICAgICAgICJ4ZW5vIiwKICAgICAgICAic29sYXJhIiwKICAgICAgICAiampzcGxvaXQiCiAgICB9CgogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpCiAgICBsb2NhbCBJc0JsYWNrbGlzdGVkID0gdGFibGUuZmluZChCbGFja2xpc3RlZCwgTmFtZSkKCiAgICAtLS8vIFNvbWUgZXhlY3V0b3JzIGhhdmUgYnJva2VuIGZ1bmN0aW9uYWxpdHkKICAgIGlmIElzQmxhY2tsaXN0ZWQgdGhlbgogICAgICAgIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWUpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tGdW5jdGlvbnMoKTogYm9vbGVhbgogICAgbG9jYWwgQ29yZUZ1bmN0aW9ucyA9IHsKICAgICAgICAiaG9va21ldGFtZXRob2QiLAogICAgICAgICJob29rZnVuY3Rpb24iLAogICAgICAgICJnZXRyYXdtZXRhdGFibGUiLAogICAgICAgICJzZXRyZWFkb25seSIKICAgIH0KCiAgICAtLS8vIENoZWNrIGlmIHRoZSBmdW5jdGlvbnMgZXhpc3QgaW4gdGhlIEVOVgogICAgZm9yIF8sIE5hbWUgaW4gQ29yZUZ1bmN0aW9ucyBkbwogICAgICAgIGxvY2FsIEZ1bmMgPSBzZWxmOkZ1bmNFeGlzdHMoTmFtZSkKICAgICAgICBpZiBGdW5jIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIC0tLy8gRnVuY3Rpb24gbWlzc2luZyEKICAgICAgICBVaTpTaG93VW5zdXBwb3J0ZWQoTmFtZSkKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIHJldHVybiB0cnVlCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDaGVja0lzU3VwcG9ydGVkKCk6IGJvb2xlYW4KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGV4ZWN1dG9yIGlzIGJsYWNrbGlzdGVkCiAgICBsb2NhbCBFeGVjdXRvclN1cHBvcnRlZCA9IHNlbGY6Q2hlY2tFeGVjdXRvcigpCiAgICBpZiBub3QgRXhlY3V0b3JTdXBwb3J0ZWQgdGhlbgogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgY29yZSBmdW5jdGlvbnMgZXhpc3QKICAgIGxvY2FsIEZ1bmN0aW9uc1N1cHBvcnRlZCA9IHNlbGY6Q2hlY2tGdW5jdGlvbnMoKQogICAgaWYgbm90IEZ1bmN0aW9uc1N1cHBvcnRlZCB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0Q2xhc3NEYXRhKFJlbW90ZTogSW5zdGFuY2UpOiB0YWJsZT8KICAgIGxvY2FsIFJlbW90ZUNsYXNzRGF0YSA9IHNlbGYuUmVtb3RlQ2xhc3NEYXRhCiAgICBsb2NhbCBDbGFzc05hbWUgPSBIb29rOkluZGV4KFJlbW90ZSwgIkNsYXNzTmFtZSIpCgogICAgcmV0dXJuIFJlbW90ZUNsYXNzRGF0YVtDbGFzc05hbWVdCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGU6IEluc3RhbmNlKTogYm9vbGVhbgogICAgbG9jYWwgSXNEZWJ1ZyA9IFJlbW90ZSA9PSBDb21tdW5pY2F0aW9uLkRlYnVnSWRSZW1vdGUKICAgIGxvY2FsIElzQ2hhbm5lbCA9IFJlbW90ZSA9PSAoQ2hhbm5lbFdyYXBwZWQgYW5kIENoYW5uZWwuQ2hhbm5lbCBvciBDaGFubmVsKQoKICAgIHJldHVybiBJc0RlYnVnIG9yIElzQ2hhbm5lbAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6UmVtb3RlQWxsb3dlZChSZW1vdGU6IEluc3RhbmNlLCBUcmFuc2ZlclR5cGU6IHN0cmluZywgTWV0aG9kOiBzdHJpbmc/KTogYm9vbGVhbj8KICAgIGlmIHR5cGVvZihSZW1vdGUpIH49ICdJbnN0YW5jZScgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIC0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBpcyBwcm90ZWN0ZWQKICAgIGlmIHNlbGY6SXNQcm90ZWN0ZWRSZW1vdGUoUmVtb3RlKSB0aGVuIHJldHVybiBlbmQKCiAgICAtLS8vIEZldGNoIGNsYXNzIHRhYmxlCglsb2NhbCBDbGFzc0RhdGEgPSBzZWxmOkdldENsYXNzRGF0YShSZW1vdGUpCglpZiBub3QgQ2xhc3NEYXRhIHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHRyYW5zZmVyIHR5cGUgaGFzIGRhdGEKCWxvY2FsIEFsbG93ZWQgPSBDbGFzc0RhdGFbVHJhbnNmZXJUeXBlXQoJaWYgbm90IEFsbG93ZWQgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgbWV0aG9kIGlzIGFsbG93ZWQKCWlmIE1ldGhvZCB0aGVuCgkJcmV0dXJuIHRhYmxlLmZpbmQoQWxsb3dlZCwgTWV0aG9kKSB+PSBuaWwKCWVuZAoKCXJldHVybiB0cnVlCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpTZXRFeHRyYURhdGEoRGF0YTogdGFibGUpCiAgICBpZiBub3QgRGF0YSB0aGVuIHJldHVybiBlbmQKICAgIHNlbGYuRXh0cmFEYXRhID0gRGF0YQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlOiBJbnN0YW5jZSwgTWV0aG9kOiBzdHJpbmcsIC4uLik6IHRhYmxlPwogICAgbG9jYWwgU3Bvb2YgPSBSZXR1cm5TcG9vZnNbUmVtb3RlXQoKICAgIGlmIG5vdCBTcG9vZiB0aGVuIHJldHVybiBlbmQKICAgIGlmIFNwb29mLk1ldGhvZCB+PSBNZXRob2QgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgUmV0dXJuVmFsdWVzID0gU3Bvb2YuUmV0dXJuCgogICAgLS0vLyBDYWxsIHRoZSBSZXR1cm5WYWx1ZXMgZnVuY3Rpb24gdHlwZQogICAgaWYgdHlwZW9mKFJldHVyblZhbHVlcykgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgUmV0dXJuVmFsdWVzID0gUmV0dXJuVmFsdWVzKC4uLikKICAgIGVuZAoKCS0tQ29tbXVuaWNhdGlvbjpXYXJuKCJTcG9vZmVkIiwgTWV0aG9kKQoJcmV0dXJuIFJldHVyblZhbHVlcwplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6U2V0TmV3UmV0dXJuU3Bvb2ZzKE5ld1JldHVyblNwb29mczogdGFibGUpCiAgICBSZXR1cm5TcG9vZnMgPSBOZXdSZXR1cm5TcG9vZnMKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkZpbmRDYWxsaW5nTENsb3N1cmUoT2Zmc2V0OiBudW1iZXIpCiAgICBPZmZzZXQgKz0gMQoKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBPZmZzZXQgKz0gMQoKICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSBzdGFjayBsZXZlbCBpcyB2YWxpZAogICAgICAgIGxvY2FsIElzVmFsaWQgPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImwiKSB+PSAtMQogICAgICAgIGlmIG5vdCBJc1ZhbGlkIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGZ1bmN0aW9uIGlzIHZhbGlkCiAgICAgICAgbG9jYWwgRnVuY3Rpb24gPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImYiKQogICAgICAgIGlmIG5vdCBGdW5jdGlvbiB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgcmV0dXJuIEZ1bmN0aW9uCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNhbGxiYWNrKERhdGE6IFJlbW90ZURhdGEsIC4uLik6IHRhYmxlPwogICAgLS0vLyBVbnBhY2sgRGF0YQogICAgbG9jYWwgT3JpZ2luYWxGdW5jID0gRGF0YS5PcmlnaW5hbEZ1bmMKICAgIGxvY2FsIElkID0gRGF0YS5JZAogICAgbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKICAgIGxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCgogICAgbG9jYWwgUmVtb3RlRGF0YSA9IHNlbGY6R2V0UmVtb3RlRGF0YShJZCkKCiAgICAtLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgaXMgQmxvY2tlZAogICAgaWYgUmVtb3RlRGF0YS5CbG9ja2VkIHRoZW4gcmV0dXJuIHt9IGVuZAoKICAgIC0tLy8gQ2hlY2sgZm9yIGEgc3Bvb2YKICAgIGxvY2FsIFNwb29mID0gc2VsZjpHZXRSZW1vdGVTcG9vZihSZW1vdGUsIE1ldGhvZCwgT3JpZ2luYWxGdW5jLCAuLi4pCiAgICBpZiBTcG9vZiB0aGVuIHJldHVybiBTcG9vZiBlbmQKCiAgICAtLS8vIENoZWNrIGlmIHRoZSBvcmlnbmFsIGZ1bmN0aW9uIHdhcyBwYXNzZWQKICAgIGlmIG5vdCBPcmlnaW5hbEZ1bmMgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBJbnZva2Ugb3JpZ25hbCBmdW5jdGlvbgogICAgcmV0dXJuIHsKICAgICAgICBPcmlnaW5hbEZ1bmMoUmVtb3RlLCAuLi4pCiAgICB9CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpEZWNvbXBpbGUoU2NyaXB0OiBTY3JpcHQpOiBzdHJpbmcKICAgIGxvY2FsIEtvbnN0YW50QVBJID0gImh0dHA6Ly9hcGkucGx1c2dpYW50NS5jb20va29uc3RhbnQvZGVjb21waWxlIgogICAgbG9jYWwgRm9yY2VLb25zdGFudCA9IENvbmZpZy5Gb3JjZUtvbnN0YW50RGVjb21waWxlcgoKICAgIC0tLy8gVXNlIGJ1aWx0LWluIGRlY29tcGlsZXIgaWYgdGhlIGV4ZWN1dG9yIHN1cHBvcnRzIGl0CiAgICBpZiBkZWNvbXBpbGUgYW5kIG5vdCBGb3JjZUtvbnN0YW50IHRoZW4gCiAgICAgICAgcmV0dXJuIGRlY29tcGlsZShTY3JpcHQpCiAgICBlbmQKCiAgICAtLS8vIGdldHNjcmlwdGJ5dGVjb2RlCiAgICBsb2NhbCBTdWNjZXNzLCBCeXRlY29kZSA9IHBjYWxsKGdldHNjcmlwdGJ5dGVjb2RlLCBTY3JpcHQpCiAgICBpZiBub3QgU3VjY2VzcyB0aGVuCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1GYWlsZWQgdG8gZ2V0IHNjcmlwdCBieXRlY29kZSwgZXJyb3I6XG5gCiAgICAgICAgRXJyb3IgLi49IGBcbi0tW1tcbntCeXRlY29kZX1cbl1dYAogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQogICAgZW5kCiAgICAKICAgIC0tLy8gU2VuZCBQT1NUIHJlcXVlc3QgdG8gdGhlIEFQSQogICAgbG9jYWwgUmVzcG9uY2UgPSByZXF1ZXN0KHsKICAgICAgICBVcmwgPSBLb25zdGFudEFQSSwKICAgICAgICBCb2R5ID0gQnl0ZWNvZGUsCiAgICAgICAgTWV0aG9kID0gIlBPU1QiLAogICAgICAgIEhlYWRlcnMgPSB7CiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAidGV4dC9wbGFpbiIKICAgICAgICB9LAogICAgfSkKCiAgICAtLS8vIEVycm9yIGNoZWNrCiAgICBpZiBSZXNwb25jZS5TdGF0dXNDb2RlIH49IDIwMCB0aGVuCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1bS09OU1RBTlRdIEVycm9yIG9jY3VyZWQgd2hpbGUgcmVxdWVzdGluZyB0aGUgQVBJLCBlcnJvcjpcbmAKICAgICAgICBFcnJvciAuLj0gYFxuLS1bW1xue1Jlc3BvbmNlLkJvZHl9XG5dXWAKICAgICAgICByZXR1cm4gRXJyb3IsIHRydWUKICAgIGVuZAoKICAgIHJldHVybiBSZXNwb25jZS5Cb2R5CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpHZXRTY3JpcHRGcm9tRnVuYyhGdW5jOiAoLi4uYW55KSAtPiAuLi5hbnkpCiAgICBsb2NhbCBFTlYgPSBnZXRmZW52KEZ1bmMpCiAgICBpZiBzZWxmOklzU2lnbWFTcHlFTlYoRU5WKSB0aGVuIAogICAgICAgIHJldHVybiAKICAgIGVuZAoKICAgIHJldHVybiByYXdnZXQoRU5WLCAic2NyaXB0IikKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNvbm5lY3Rpb25Jc1ZhbGlkKENvbm5lY3Rpb246IHRhYmxlKTogYm9vbGVhbgogICAgbG9jYWwgVmFsdWVSZXBsYWNlbWVudHMgPSB7CgkJWyJTY3JpcHQiXSA9IGZ1bmN0aW9uKENvbm5lY3Rpb246IHRhYmxlKTogc2NyaXB0PwoJCQlsb2NhbCBGdW5jdGlvbiA9IENvbm5lY3Rpb24uRnVuY3Rpb24KCQkJaWYgbm90IEZ1bmN0aW9uIHRoZW4gcmV0dXJuIGVuZAoKCQkJcmV0dXJuIHNlbGY6R2V0U2NyaXB0RnJvbUZ1bmMoRnVuY3Rpb24pCgkJZW5kCgl9CgogICAgLS0vLyBDaGVjayBpZiB0aGVzZSBwcm9wZXJ0aWVzIGFyZSB2YWxpZAogICAgbG9jYWwgVG9DaGVjayA9IHsKICAgICAgICAiU2NyaXB0IgogICAgfQoKICAgIGZvciBfLCBQcm9wZXJ0eSBpbiBUb0NoZWNrIGRvCiAgICAgICAgbG9jYWwgUmVwbGFjZW1lbnQgPSBWYWx1ZVJlcGxhY2VtZW50c1tQcm9wZXJ0eV0KCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGVyZSdzIGEgZnVuY3Rpb24gZm9yIGEgcHJvcGVydHkKICAgICAgICBpZiBSZXBsYWNlbWVudCB0aGVuCiAgICAgICAgICAgIFZhbHVlID0gUmVwbGFjZW1lbnQoQ29ubmVjdGlvbikKICAgICAgICBlbmQKCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgcHJvcGVydHkgaGFzIGEgdmFsdWUKICAgICAgICBpZiBWYWx1ZSA9PSBuaWwgdGhlbiAKICAgICAgICAgICAgcmV0dXJuIGZhbHNlIAogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIHRydWUKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkZpbHRlckNvbm5lY3Rpb25zKFNpZ25hbDogUkJYU2NyaXB0Q29ubmVjdGlvbik6IHRhYmxlCiAgICBsb2NhbCBQcm9jZXNzZWQgPSB7fQoKICAgIC0tLy8gRmlsdGVyIGVhY2ggY29ubmVjdGlvbgogICAgZm9yIF8sIENvbm5lY3Rpb24gaW4gZ2V0Y29ubmVjdGlvbnMoU2lnbmFsKSBkbwogICAgICAgIGlmIG5vdCBzZWxmOkNvbm5lY3Rpb25Jc1ZhbGlkKENvbm5lY3Rpb24pIHRoZW4gY29udGludWUgZW5kCiAgICAgICAgdGFibGUuaW5zZXJ0KFByb2Nlc3NlZCwgQ29ubmVjdGlvbikKICAgIGVuZAoKICAgIHJldHVybiBQcm9jZXNzZWQKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOklzU2lnbWFTcHlFTlYoRW52OiB0YWJsZSk6IGJvb2xlYW4KICAgIHJldHVybiBFTlYgPT0gU2lnbWFFTlYKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoRGF0YTogUmVtb3RlRGF0YSwgLi4uKTogdGFibGU/CiAgICAtLS8vIFVucGFjayBEYXRhCiAgICBsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKICAgIGxvY2FsIFRyYW5zZmVyVHlwZSA9IERhdGEuVHJhbnNmZXJUeXBlCgoJLS0vLyBDaGVjayBpZiB0aGUgdHJhbnNmZXJ0eXBlIG1ldGhvZCBpcyBhbGxvd2VkCglpZiBUcmFuc2ZlclR5cGUgYW5kIG5vdCBzZWxmOlJlbW90ZUFsbG93ZWQoUmVtb3RlLCBUcmFuc2ZlclR5cGUsIE1ldGhvZCkgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBGZXRjaCBkZXRhaWxzCiAgICBsb2NhbCBJZCA9IENvbW11bmljYXRpb246R2V0RGVidWdJZChSZW1vdGUpCiAgICBsb2NhbCBDbGFzc0RhdGEgPSBzZWxmOkdldENsYXNzRGF0YShSZW1vdGUpCiAgICBsb2NhbCBUaW1lc3RhbXAgPSB0aWNrKCkKCiAgICAtLS8vIEFkZCBleHRyYSBkYXRhIGludG8gdGhlIGxvZyBpZiBuZWVkZWQKICAgIGxvY2FsIEV4dHJhRGF0YSA9IHNlbGYuRXh0cmFEYXRhCiAgICBpZiBFeHRyYURhdGEgdGhlbgogICAgICAgIE1lcmdlKERhdGEsIEV4dHJhRGF0YSkKICAgIGVuZAoKICAgIC0tLy8gR2V0IGNhbGxlciBpbmZvcm1hdGlvbgogICAgbG9jYWwgQ2FsbGluZ0Z1bmN0aW9uID0gc2VsZjpGaW5kQ2FsbGluZ0xDbG9zdXJlKDYpCiAgICBsb2NhbCBTb3VyY2VTY3JpcHQKICAgIGlmIENhbGxpbmdGdW5jdGlvbiB0aGVuCiAgICAgICAgU291cmNlU2NyaXB0ID0gc2VsZjpHZXRTY3JpcHRGcm9tRnVuYyhDYWxsaW5nRnVuY3Rpb24pCiAgICBlbmQKCiAgICAtLS8vIEFkZCB0byBxdWV1ZQogICAgTWVyZ2UoRGF0YSwgewoJCUNhbGxpbmdTY3JpcHQgPSBnZXRjYWxsaW5nc2NyaXB0KCksCiAgICAgICAgU291cmNlU2NyaXB0ID0gU291cmNlU2NyaXB0LAoJCUNhbGxpbmdGdW5jdGlvbiA9IENhbGxpbmdGdW5jdGlvbiwKICAgICAgICBJZCA9IElkLAoJCUNsYXNzRGF0YSA9IENsYXNzRGF0YSwKICAgICAgICBUaW1lc3RhbXAgPSBUaW1lc3RhbXAsCiAgICAgICAgQXJncyA9IENvbW11bmljYXRpb246U2VyaWFsaXplVGFibGUoey4uLn0pCiAgICB9KQoKICAgIC0tLy8gSW52b2tlIHRoZSBSZW1vdGUgYW5kIGxvZyByZXR1cm4gdmFsdWVzCiAgICBsb2NhbCBSZXR1cm5WYWx1ZXMgPSBzZWxmOkNhbGxiYWNrKERhdGEsIC4uLikKICAgIERhdGEuUmV0dXJuVmFsdWVzID0gUmV0dXJuVmFsdWVzCgogICAgLS0vLyBRdWV1ZSBsb2cKICAgIENvbW11bmljYXRpb246UXVldWVMb2coRGF0YSkKCiAgICByZXR1cm4gUmV0dXJuVmFsdWVzCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpTZXRBbGxSZW1vdGVEYXRhKEtleTogc3RyaW5nLCBWYWx1ZSkKICAgIGxvY2FsIFJlbW90ZU9wdGlvbnMgPSBzZWxmLlJlbW90ZU9wdGlvbnMKCWZvciBSZW1vdGVJRCwgRGF0YSBpbiBuZXh0LCBSZW1vdGVPcHRpb25zIGRvCgkJRGF0YVtLZXldID0gVmFsdWUKCWVuZAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZDogc3RyaW5nKQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucwoKICAgIC0tLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIHJlbW90ZSBkYXRhCglsb2NhbCBFeGlzdGluZyA9IFJlbW90ZU9wdGlvbnNbSWRdCglpZiBFeGlzdGluZyB0aGVuIHJldHVybiBFeGlzdGluZyBlbmQKCQogICAgLS0vLyBCYXNlIHJlbW90ZSBkYXRhCglsb2NhbCBEYXRhID0gewoJCUV4Y2x1ZGVkID0gZmFsc2UsCgkJQmxvY2tlZCA9IGZhbHNlCgl9CgoJUmVtb3RlT3B0aW9uc1tJZF0gPSBEYXRhCglyZXR1cm4gRGF0YQplbmQKCi0tLy8gVGhlIGNvbW11bmljYXRpb24gY3JlYXRlcyBhIGRpZmZlcmVudCB0YWJsZSBhZGRyZXNzCi0tLy8gUmVjaXZlZCB0YWJsZXMgd2lsbCBub3QgYmUgdGhlIHNhbWUKZnVuY3Rpb24gUHJvY2VzczpTZXRSZW1vdGVEYXRhKElkOiBzdHJpbmcsIFJlbW90ZURhdGE6IHRhYmxlKQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucwogICAgUmVtb3RlT3B0aW9uc1tJZF0gPSBSZW1vdGVEYXRhCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpVcGRhdGVSZW1vdGVEYXRhKElkOiBzdHJpbmcsIFJlbW90ZURhdGE6IHRhYmxlKQogICAgQ29tbXVuaWNhdGlvbjpDb21tdW5pY2F0ZSgiUmVtb3RlRGF0YSIsIElkLCBSZW1vdGVEYXRhKQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YShLZXk6IHN0cmluZywgVmFsdWUpCiAgICBDb21tdW5pY2F0aW9uOkNvbW11bmljYXRlKCJBbGxSZW1vdGVEYXRhIiwgS2V5LCBWYWx1ZSkKZW5kCgpyZXR1cm4gUHJvY2Vzcw=="},
	Hook = {"base64", "bG9jYWwgSG9vayA9IHsKCU9yaWduYWxOYW1lY2FsbCA9IG5pbCwKCU9yaWduYWxJbmRleCA9IG5pbCwKfQoKdHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBNZXRhQ2FsbGJhY2sgPSAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55CgotLS8vIE1vZHVsZXMKbG9jYWwgTW9kdWxlcwpsb2NhbCBQcm9jZXNzCmxvY2FsIENvbmZpZ3VyYXRpb24KbG9jYWwgQ29uZmlnCgpsb2NhbCBFeGVFTlYgPSBnZXRmZW52KDEpCgpmdW5jdGlvbiBIb29rOkluaXQoRGF0YSkKICAgIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCglDb25maWcgPSBNb2R1bGVzLkNvbmZpZyBvciBDb25maWcKCUNvbmZpZ3VyYXRpb24gPSBNb2R1bGVzLkNvbmZpZ3VyYXRpb24gb3IgQ29uZmlndXJhdGlvbgplbmQKCi0tLy8gVGhlIGNhbGxiYWNrIGlzIGV4cGVjdGVkIHRvIHJldHVybiBhIG5pbCB2YWx1ZSBzb21ldGltZXMgd2hpY2ggc2hvdWxkIGJlIGluZ29yZWQKbG9jYWwgSG9va01pZGRsZSA9IG5ld2NjbG9zdXJlKGZ1bmN0aW9uKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIC4uLikKCS0tLy8gSW52b2tlIGNhbGxiYWNrIGFuZCBjaGVjayBmb3IgYSByZXBvbmNlIG90aGVyd2lzZSBpZ25vcmVkCglsb2NhbCBSZXR1cm5WYWx1ZXMgPSBDYWxsYmFjayguLi4pCglpZiBSZXR1cm5WYWx1ZXMgdGhlbgoJCXJldHVybiBQcm9jZXNzOlVucGFjayhSZXR1cm5WYWx1ZXMpCgllbmQKCgktLS8vIEludm9rZSBvcmlnbmFsIGZ1bmN0aW9uCglyZXR1cm4gT3JpZ2luYWxGdW5jKC4uLikKZW5kKQoKLS0vLyBnZXRyYXdtZXRhdGFibGUKZnVuY3Rpb24gSG9vazpSZXBsYWNlTWV0YU1ldGhvZChPYmplY3Q6IEluc3RhbmNlLCBDYWxsOiBzdHJpbmcsIENhbGxiYWNrOiBNZXRhQ2FsbGJhY2spOiBNZXRhQ2FsbGJhY2sKCWxvY2FsIE1ldGF0YWJsZSA9IGdldHJhd21ldGF0YWJsZShPYmplY3QpCglsb2NhbCBPcmlnaW5hbEZ1bmMgPSByYXdnZXQoTWV0YXRhYmxlLCBDYWxsKQoJCgktLS8vIFJlcGxhY2UgZnVuY3Rpb24KCXNldHJlYWRvbmx5KE1ldGF0YWJsZSwgZmFsc2UpCglyYXdzZXQoTWV0YXRhYmxlLCBDYWxsLCBuZXdjY2xvc3VyZShmdW5jdGlvbiguLi4pCgkJcmV0dXJuIEhvb2tNaWRkbGUoT3JpZ2luYWxGdW5jLCBDYWxsYmFjaywgLi4uKQoJZW5kKSkKCXNldHJlYWRvbmx5KE1ldGF0YWJsZSwgdHJ1ZSkKCglyZXR1cm4gT3JpZ2luYWxGdW5jCmVuZAoKLS0vLyBob29rZnVuY3Rpb24KZnVuY3Rpb24gSG9vazpIb29rRnVuY3Rpb24oRnVuYzogKC4uLmFueSkgLT4gLi4uYW55LCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55KQoJbG9jYWwgT3JpZ2luYWxGdW5jCglPcmlnaW5hbEZ1bmMgPSBob29rZnVuY3Rpb24oRnVuYywgZnVuY3Rpb24oLi4uKQoJCXJldHVybiBIb29rTWlkZGxlKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIC4uLikKCWVuZCkKCXJldHVybiBPcmlnaW5hbEZ1bmMKZW5kCgotLS8vIGhvb2ttZXRhbWV0aG9kCmZ1bmN0aW9uIEhvb2s6SG9va01ldGFDYWxsKE9iamVjdDogSW5zdGFuY2UsIENhbGw6IHN0cmluZywgQ2FsbGJhY2s6IE1ldGFDYWxsYmFjayk6IE1ldGFDYWxsYmFjawoJbG9jYWwgT3JpZ2luYWxGdW5jCglPcmlnaW5hbEZ1bmMgPSBob29rbWV0YW1ldGhvZChPYmplY3QsIENhbGwsIG5ld2NjbG9zdXJlKGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShPcmlnaW5hbEZ1bmMsIENhbGxiYWNrLCAuLi4pCgllbmQpKQoJcmV0dXJuIE9yaWdpbmFsRnVuYwplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va01ldGFNZXRob2QoT2JqZWN0OiBJbnN0YW5jZSwgQ2FsbDogc3RyaW5nLCBDYWxsYmFjazogTWV0YUNhbGxiYWNrKTogTWV0YUNhbGxiYWNrCgktLS8vIEdldHJhd21ldGF0YWJsZQoJaWYgQ29uZmlnLlJlcGxhY2VNZXRhQ2FsbEZ1bmMgdGhlbgoJCXJldHVybiBzZWxmOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdCwgQ2FsbCwgQ2FsbGJhY2spCgllbmQKCQoJLS0vLyBIb29rbWV0YW1ldGhvZAoJcmV0dXJuIHNlbGY6SG9va01ldGFDYWxsKE9iamVjdCwgQ2FsbCwgQ2FsbGJhY2spCmVuZAoKLS0vLyBUaGlzIGluY2x1ZGVzIGEgZmV3IHBhdGNoZXMgZm9yIGV4ZWN1dG9yIGZ1bmN0aW9ucyB0aGF0IHJlc3VsdCBpbiBkZXRlY3Rpb24KLS0vLyBUaGlzIGlzbid0IGJ1bGxldHByb29mIHNpbmNlIHNvbWUgZnVuY3Rpb25zIGxpa2UgaG9va2Z1bmN0aW9uIEkgY2FuJ3QgcGF0Y2gKZnVuY3Rpb24gSG9vazpQYXRjaEZ1bmN0aW9ucygpCgktLS8vIENoZWNrIGlmIHRoaXMgZnVuY3Rpb24gaXMgZGlzYWJsZWQgaW4gdGhlIGNvbmZpZ3VyYXRpb24KCWlmIENvbmZpZy5Ob0Z1bmN0aW9uUGF0Y2hpbmcgdGhlbiByZXR1cm4gZW5kCgoJbG9jYWwgUGF0Y2hlcyA9IHsKCQktLS8vIEVycm9yIGRldGVjdGlvbiBwYXRjaAoJCS0tLy8gaG9va2Z1bmN0aW9uIG1heSBzdGlsbCBiZSBkZXRlY3RlZCBkZXBlbmRpbmcgb24gdGhlIGV4ZWN1dG9yCgkJW3BjYWxsXSA9ICBmdW5jdGlvbihPbGRGdW5jLCBGdW5jLCAuLi4pCgkJCWxvY2FsIFJlc3BvbmNlID0ge09sZEZ1bmMoRnVuYywgLi4uKX0KCQkJbG9jYWwgU3VjY2VzcywgRXJyb3IgPSBSZXNwb25jZVsxXSwgUmVzcG9uY2VbMl0KCgkJCS0tLy8gUGF0Y2ggYy1jbG9zdXJlIGVycm9yIGRldGVjdGlvbgoJCQlpZiBTdWNjZXNzID09IGZhbHNlIGFuZCBpc2NjbG9zdXJlKEZ1bmMpIHRoZW4KCQkJCWxvY2FsIE5ld0Vycm9yID0gUHJvY2VzczpDbGVhbkNFcnJvcihFcnJvcikKCQkJCVJlc3BvbmNlWzJdID0gTmV3RXJyb3IKCQkJZW5kCgoJCQlyZXR1cm4gUHJvY2VzczpVbnBhY2soUmVzcG9uY2UpCgkJZW5kLAoJCVtnZXRmZW52XSA9IGZ1bmN0aW9uKE9sZEZ1bmMsIExldmVsOiBudW1iZXIsIC4uLikKCQkJbG9jYWwgUmVzcG9uY2UgPSB7T2xkRnVuYyhMZXZlbCwgLi4uKX0KCQkJbG9jYWwgRU5WID0gUmVzcG9uY2VbMV0KCgkJCS0tLy8gX190b3N0cmluZyBFTlYgZGV0ZWN0aW9uIHBhdGNoCgkJCWlmIG5vdCBjaGVja2NhbGxlcigpIGFuZCBFTlYgPT0gRXhlRU5WIHRoZW4KCQkJCXJldHVybiBPbGRGdW5jKDk5OTk5OSwgLi4uKQoJCQllbmQKCgkJCXJldHVybiBQcm9jZXNzOlVucGFjayhSZXNwb25jZSkKCQllbmQKCX0KCgktLS8vIEhvb2sgZWFjaCBmdW5jdGlvbgoJZm9yIEZ1bmMsIENhbGxCYWNrIGluIFBhdGNoZXMgZG8KCQlsb2NhbCBPbGRGdW5jID0gY2xvbmVmdW5jdGlvbihGdW5jKQoJCWhvb2tmdW5jdGlvbihGdW5jLCBuZXdjY2xvc3VyZShmdW5jdGlvbiguLi4pCgkJCXJldHVybiBDYWxsQmFjayhPbGRGdW5jLCAuLi4pCgkJZW5kKSkKCWVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIE1lcmdlKEJhc2U6IHRhYmxlLCBOZXc6IHRhYmxlKQoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvCgkJQmFzZVtLZXldID0gVmFsdWUKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6UnVuT25BY3RvcnMoQ29kZTogc3RyaW5nLCBDaGFubmVsSWQ6IG51bWJlcikKCWlmIG5vdCBnZXRhY3RvcnMgdGhlbiByZXR1cm4gZW5kCgkKCWxvY2FsIEFjdG9ycyA9IGdldGFjdG9ycygpCglpZiBub3QgQWN0b3JzIHRoZW4gcmV0dXJuIGVuZAoJCglmb3IgXywgQWN0b3IgaW4gQWN0b3JzIGRvIAoJCXJ1bl9vbl9hY3RvcihBY3RvciwgQ29kZSwgQ2hhbm5lbElkKQoJZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gUHJvY2Vzc1JlbW90ZShPcmlnaW5hbEZ1bmMsIE1ldGFNZXRob2Q6IHN0cmluZywgc2VsZiwgTWV0aG9kOiBzdHJpbmcsIC4uLikKCXJldHVybiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoewoJCVJlbW90ZSA9IHNlbGYsCgkJTWV0aG9kID0gTWV0aG9kLAoJCU9yaWdpbmFsRnVuYyA9IE9yaWdpbmFsRnVuYywKCQlNZXRhTWV0aG9kID0gTWV0YU1ldGhvZCwKCQlUcmFuc2ZlclR5cGUgPSAiU2VuZCIsCgkJSXNFeHBsb2l0ID0gY2hlY2tjYWxsZXIoKQoJfSwgLi4uKQplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va1JlbW90ZVR5cGVJbmRleChDbGFzc05hbWU6IHN0cmluZywgRnVuY05hbWU6IHN0cmluZykKCWxvY2FsIFJlbW90ZSA9IEluc3RhbmNlLm5ldyhDbGFzc05hbWUpCglsb2NhbCBGdW5jID0gUmVtb3RlW0Z1bmNOYW1lXQoJbG9jYWwgT3JpZ2luYWxGdW5jCgoJLS0vLyBSZW1vdGVzIHdpbGwgc2hhcmUgdGhlIHNhbWUgZnVuY3Rpb25zCgktLS8vIAlGb3IgZXhhbXBsZSBGaXJlU2VydmVyIHdpbGwgYmUgaWRlbnRpY2FsCgktLS8vIEFkZGlvbmFsbHksIHRoaXMgaXMgZm9yIF9faW5kZXggY2FsbHMuCgktLS8vIAlBIF9fbmFtZWNhbGwgaG9vayB3aWxsIG5vdCBkZXRlY3QgdGhpcwoJT3JpZ2luYWxGdW5jID0gc2VsZjpIb29rRnVuY3Rpb24oRnVuYywgZnVuY3Rpb24oc2VsZiwgLi4uKQoJCS0tLy8gQ2hlY2sgaWYgdGhlIE9iamVjdCBpcyBhbGxvd2VkIAoJCWlmIG5vdCBQcm9jZXNzOlJlbW90ZUFsbG93ZWQoc2VsZiwgIlNlbmQiLCBGdW5jTmFtZSkgdGhlbiByZXR1cm4gZW5kCgoJCS0tLy8gUHJvY2VzcyB0aGUgcmVtb3RlIGRhdGEKCQlyZXR1cm4gUHJvY2Vzc1JlbW90ZShPcmlnaW5hbEZ1bmMsICJfX2luZGV4Iiwgc2VsZiwgRnVuY05hbWUsIC4uLikKCWVuZCkKZW5kCgpmdW5jdGlvbiBIb29rOkhvb2tSZW1vdGVJbmRleGVzKCkKCWxvY2FsIFJlbW90ZUNsYXNzRGF0YSA9IFByb2Nlc3MuUmVtb3RlQ2xhc3NEYXRhCglmb3IgQ2xhc3NOYW1lLCBEYXRhIGluIFJlbW90ZUNsYXNzRGF0YSBkbwoJCWxvY2FsIEZ1bmNOYW1lID0gRGF0YS5TZW5kWzFdCgkJc2VsZjpIb29rUmVtb3RlVHlwZUluZGV4KENsYXNzTmFtZSwgRnVuY05hbWUpCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOkJlZ2luSG9va3MoKQoJLS0vLyBIb29rIFJlbW90ZSBmdW5jdGlvbnMKCXNlbGY6SG9va1JlbW90ZUluZGV4ZXMoKQoKCS0tLy8gTmFtZWNhbGwgaG9vawoJbG9jYWwgT3JpZ2luYWxOYW1lQ2FsbAoJT3JpZ2luYWxOYW1lQ2FsbCA9IHNlbGY6SG9va01ldGFNZXRob2QoZ2FtZSwgIl9fbmFtZWNhbGwiLCBmdW5jdGlvbihzZWxmLCAuLi4pCgkJbG9jYWwgTWV0aG9kID0gZ2V0bmFtZWNhbGxtZXRob2QoKQoJCXJldHVybiBQcm9jZXNzUmVtb3RlKE9yaWdpbmFsTmFtZUNhbGwsICJfX25hbWVjYWxsIiwgc2VsZiwgTWV0aG9kLCAuLi4pCgllbmQpCgoJTWVyZ2Uoc2VsZiwgewoJCU9yaWduYWxOYW1lY2FsbCA9IE9yaWdpbmFsTmFtZUNhbGwsCgkJLS1PcmlnbmFsSW5kZXggPSBPaQoJfSkKZW5kCgpmdW5jdGlvbiBIb29rOkluZGV4KE9iamVjdDogSW5zdGFuY2UsIEtleTogc3RyaW5nKQoJcmV0dXJuIE9iamVjdFtLZXldCmVuZAoKZnVuY3Rpb24gSG9vazpQdXNoQ29uZmlnKE92ZXJ3cml0ZXMpCiAgICBNZXJnZShzZWxmLCBPdmVyd3JpdGVzKQplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va0NsaWVudEludm9rZShSZW1vdGUsIE1ldGhvZCwgQ2FsbGJhY2spCglsb2NhbCBTdWNjZXNzLCBGdW5jdGlvbiA9IHBjYWxsKGZ1bmN0aW9uKCkKCQlyZXR1cm4gZ2V0Y2FsbGJhY2t2YWx1ZShSZW1vdGUsIE1ldGhvZCkKCWVuZCkKCgktLS8vIFNvbWUgZXhlY3V0b3JzIGxpa2UgUG90YXNzaXVtIHdpbGwgdGhyb3cgYSBlcnJvciBpZiB0aGUgQ2FsbGJhY2sgdmFsdWUgaXMgbmlsCglpZiBub3QgU3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCQoJbG9jYWwgSG9va1N1Y2Nlc3MgPSBwY2FsbChmdW5jdGlvbigpCgkJc2VsZjpIb29rRnVuY3Rpb24oRnVuY3Rpb24sIGZ1bmN0aW9uKHNlbGYsIC4uLikKCQkJcmV0dXJuIENhbGxiYWNrKC4uLikKCQllbmQpCgllbmQpCgkKCWlmIEhvb2tTdWNjZXNzIHRoZW4gcmV0dXJuIGVuZAoJUmVtb3RlW01ldGhvZF0gPSBDYWxsYmFjawplbmQKCmZ1bmN0aW9uIEhvb2s6TXVsdGlDb25uZWN0KFJlbW90ZXMpCglmb3IgXywgUmVtb3RlIGluIG5leHQsIFJlbW90ZXMgZG8KCQlzZWxmOkNvbm5lY3RDbGllbnRSZWNpdmUoUmVtb3RlKQoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCS0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBjbGFzcyBpcyBhbGxvd2VkIGZvciByZWNlaXZpbmcKCWxvY2FsIEFsbG93ZWQgPSBQcm9jZXNzOlJlbW90ZUFsbG93ZWQoUmVtb3RlLCAiUmVjZWl2ZSIpCglpZiBub3QgQWxsb3dlZCB0aGVuIHJldHVybiBlbmQKCgktLS8vIENoZWNrIGlmIHRoZSBPYmplY3QgaGFzIFJlbW90ZSBjbGFzcyBkYXRhCiAgICBsb2NhbCBDbGFzc0RhdGEgPSBQcm9jZXNzOkdldENsYXNzRGF0YShSZW1vdGUpCiAgICBsb2NhbCBJc1JlbW90ZUZ1bmN0aW9uID0gQ2xhc3NEYXRhLklzUmVtb3RlRnVuY3Rpb24KCWxvY2FsIE5vUmVjaXZlSG9vayA9IENsYXNzRGF0YS5Ob1JlY2l2ZUhvb2sKICAgIGxvY2FsIE1ldGhvZCA9IENsYXNzRGF0YS5SZWNlaXZlWzFdCglsb2NhbCBQcmV2aW91c0Z1bmN0aW9uID0gbmlsCgoJLS0vLyBDaGVjayBpZiB0aGUgUmVjaXZlIHNob3VsZCBiZSBob29rZWQKCWlmIE5vUmVjaXZlSG9vayB0aGVuIHJldHVybiBlbmQKCgktLS8vIE5ldyBjYWxsYmFjayBmdW5jdGlvbgoJbG9jYWwgZnVuY3Rpb24gQ2FsbGJhY2soLi4uKQogICAgICAgIHJldHVybiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoewogICAgICAgICAgICBSZW1vdGUgPSBSZW1vdGUsCiAgICAgICAgICAgIE1ldGhvZCA9IE1ldGhvZCwKICAgICAgICAgICAgT3JpZ2luYWxGdW5jID0gUHJldmlvdXNGdW5jdGlvbiwKICAgICAgICAgICAgSXNSZWNlaXZlID0gdHJ1ZSwKICAgICAgICAgICAgTWV0YU1ldGhvZCA9ICJDb25uZWN0IiwKCQkJSXNFeHBsb2l0ID0gY2hlY2tjYWxsZXIoKQogICAgICAgIH0sIC4uLikKCWVuZAoKCS0tLy8gQ29ubmVjdCByZW1vdGUKCWlmIG5vdCBJc1JlbW90ZUZ1bmN0aW9uIHRoZW4KICAgCQlSZW1vdGVbTWV0aG9kXTpDb25uZWN0KENhbGxiYWNrKQoJZWxzZSAtLSBSZW1vdGUgZnVuY3Rpb25zCgkJc2VsZjpIb29rQ2xpZW50SW52b2tlKFJlbW90ZSwgTWV0aG9kLCBDYWxsYmFjaykKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6QmVnaW5TZXJ2aWNlKExpYnJhcmllcywgRXh0cmFEYXRhLCBDaGFubmVsSWQsIC4uLikKCS0tLy8gTGlicmFyZWlzCglsb2NhbCBSZXR1cm5TcG9vZnMgPSBMaWJyYXJpZXMuUmV0dXJuU3Bvb2ZzCglsb2NhbCBQcm9jZXNzTGliID0gTGlicmFyaWVzLlByb2Nlc3MKCWxvY2FsIENvbW11bmljYXRpb24gPSBMaWJyYXJpZXMuQ29tbXVuaWNhdGlvbgoJbG9jYWwgR2VuZXJhdGlvbiA9IExpYnJhcmllcy5HZW5lcmF0aW9uCglsb2NhbCBDb25maWcgPSBMaWJyYXJpZXMuQ29uZmlnCgoJLS0vLyBDaGVjayBmb3IgY29uZmlndXJhdGlvbiBvdmVyd3JpdGVzCglQcm9jZXNzTGliOkNoZWNrQ29uZmlnKENvbmZpZykKCgktLS8vIEluaXQgZGF0YQoJbG9jYWwgSW5pdERhdGEgPSB7CgkJTW9kdWxlcyA9IHsKCQkJUmV0dXJuU3Bvb2ZzID0gUmV0dXJuU3Bvb2ZzLAoJCQlHZW5lcmF0aW9uID0gR2VuZXJhdGlvbiwKCQkJQ29tbXVuaWNhdGlvbiA9IENvbW11bmljYXRpb24sCgkJCVByb2Nlc3MgPSBQcm9jZXNzTGliLAoJCQlDb25maWcgPSBDb25maWcsCgkJCUhvb2sgPSBzZWxmCgkJfSwKCQlTZXJ2aWNlcyA9IHNldG1ldGF0YWJsZSh7fSwgewoJCQlfX2luZGV4ID0gZnVuY3Rpb24oc2VsZiwgTmFtZTogc3RyaW5nKTogSW5zdGFuY2UKCQkJCWxvY2FsIFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoTmFtZSkKCQkJCXJldHVybiBjbG9uZXJlZihTZXJ2aWNlKQoJCQllbmQsCgkJfSkKCX0KCgktLS8vIEluaXQgbGlicmFyaWVzCglDb21tdW5pY2F0aW9uOkluaXQoSW5pdERhdGEpCglQcm9jZXNzTGliOkluaXQoSW5pdERhdGEpCgoJLS0vLyBDb21tdW5pY2F0aW9uIGNvbmZpZ3VyYXRpb24KCWxvY2FsIENoYW5uZWwsIElzV3JhcHBlZCA9IENvbW11bmljYXRpb246R2V0Q29tbUNoYW5uZWwoQ2hhbm5lbElkKQoJQ29tbXVuaWNhdGlvbjpTZXRDaGFubmVsKENoYW5uZWwpCglDb21tdW5pY2F0aW9uOkFkZFR5cGVDYWxsYmFja3MoewoJCVsiUmVtb3RlRGF0YSJdID0gZnVuY3Rpb24oSWQ6IHN0cmluZywgUmVtb3RlRGF0YSkKCQkJUHJvY2Vzc0xpYjpTZXRSZW1vdGVEYXRhKElkLCBSZW1vdGVEYXRhKQoJCWVuZCwKCQlbIkFsbFJlbW90ZURhdGEiXSA9IGZ1bmN0aW9uKEtleTogc3RyaW5nLCBWYWx1ZSkKCQkJUHJvY2Vzc0xpYjpTZXRBbGxSZW1vdGVEYXRhKEtleSwgVmFsdWUpCgkJZW5kLAoJCVsiVXBkYXRlU3Bvb2ZzIl0gPSBmdW5jdGlvbihDb250ZW50OiBzdHJpbmcpCgkJCWxvY2FsIFNwb29mcyA9IGxvYWRzdHJpbmcoQ29udGVudCkoKQoJCQlQcm9jZXNzTGliOlNldE5ld1JldHVyblNwb29mcyhTcG9vZnMpCgkJZW5kCgl9KQoJCgktLS8vIFByb2Nlc3MgY29uZmlndXJhdGlvbgoJUHJvY2Vzc0xpYjpTZXRDaGFubmVsKENoYW5uZWwsIElzV3JhcHBlZCkKCVByb2Nlc3NMaWI6U2V0RXh0cmFEYXRhKEV4dHJhRGF0YSkKCgktLS8vIEhvb2sgY29uZmlndXJhdGlvbgoJc2VsZjpJbml0KEluaXREYXRhKQoJc2VsZjpQYXRjaEZ1bmN0aW9ucygpCglzZWxmOkJlZ2luSG9va3MoKQplbmQKCmZ1bmN0aW9uIEhvb2s6TG9hZE1ldGFIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCgktLS8vIEhvb2sgYWN0b3JzCglpZiBub3QgQ29uZmlndXJhdGlvbi5Ob0FjdG9ycyB0aGVuCgkJd2FpdCgpCgkJc2VsZjpSdW5PbkFjdG9ycyhBY3RvckNvZGUsIENoYW5uZWxJZCkKCWVuZAoKCS0tLy8gSG9vayBjdXJyZW50IHRocmVhZAoJc2VsZjpCZWdpblNlcnZpY2UoTW9kdWxlcywgbmlsLCBDaGFubmVsSWQpIAplbmQKCmZ1bmN0aW9uIEhvb2s6TG9hZFJlY2VpdmVIb29rcygpCglsb2NhbCBOb1JlY2VpdmVIb29raW5nID0gQ29uZmlnLk5vUmVjZWl2ZUhvb2tpbmcKCWxvY2FsIEJsYWNrTGlzdGVkU2VydmljZXMgPSBDb25maWcuQmxhY2tMaXN0ZWRTZXJ2aWNlcwoKCWlmIE5vUmVjZWl2ZUhvb2tpbmcgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBSZW1vdGUgYWRkZWQKCWdhbWUuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oUmVtb3RlKSAtLSBUT0RPCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCWVuZCkKCgktLS8vIENvbGxlY3QgcmVtb3RlcyB3aXRoIG5pbCBwYXJlbnRzCglzZWxmOk11bHRpQ29ubmVjdChnZXRuaWxpbnN0YW5jZXMoKSkKCgktLS8vIFNlYXJjaCBmb3IgcmVtb3RlcwoJZm9yIF8sIFNlcnZpY2UgaW4gbmV4dCwgZ2FtZTpHZXRDaGlsZHJlbigpIGRvCgkJaWYgdGFibGUuZmluZChCbGFja0xpc3RlZFNlcnZpY2VzLCBTZXJ2aWNlLkNsYXNzTmFtZSkgdGhlbiBjb250aW51ZSBlbmQKCQlzZWxmOk11bHRpQ29ubmVjdChTZXJ2aWNlOkdldERlc2NlbmRhbnRzKCkpCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOkxvYWRIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCglzZWxmOkxvYWRNZXRhSG9va3MoQWN0b3JDb2RlLCBDaGFubmVsSWQpCglzZWxmOkxvYWRSZWNlaXZlSG9va3MoKQplbmQKCnJldHVybiBIb29r"},
	Flags = {"base64", "dHlwZSBGbGFnVmFsdWUgPSBib29sZWFufG51bWJlcnxhbnkKdHlwZSBGbGFnID0gewogICAgVmFsdWU6IEZsYWdWYWx1ZSwKICAgIExhYmVsOiBzdHJpbmcsCiAgICBDYXRlZ29yeTogc3RyaW5nCn0KdHlwZSBGbGFncyA9IHsKICAgIFtzdHJpbmddOiBGbGFnCn0KdHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKbG9jYWwgTW9kdWxlID0gewogICAgRmxhZ3MgPSB7CiAgICAgICAgUHJldmVudFJlbmFtaW5nID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyByZW5hbWluZyIsCiAgICAgICAgfSwKICAgICAgICBQcmV2ZW50UGFyZW50aW5nID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBwYXJlbnRpbmciLAogICAgICAgIH0sCiAgICAgICAgU2VsZWN0TmV3ZXN0ID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJBdXRvIHNlbGVjdCBuZXdlc3QiLAogICAgICAgIH0sCiAgICAgICAgRGVjb21waWxlUG9wb3V0ID0geyAtLSBMb3ZyZSBTSFVTSAogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJQb3Atb3V0IGRlY29tcGlsZXMiLAogICAgICAgIH0sCiAgICAgICAgSWdub3JlTmlsID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIklnbm9yZSBuaWwgcGFyZW50cyIsCiAgICAgICAgfSwKICAgICAgICBMb2dFeHBsb2l0ID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIkxvZyBleHBsb2l0IGNhbGxzIiwKICAgICAgICB9LAogICAgICAgIExvZ1JlY2l2ZXMgPSB7CiAgICAgICAgICAgIFZhbHVlID0gdHJ1ZSwKICAgICAgICAgICAgTGFiZWwgPSAiTG9nIHJlY2VpdmVzIiwKICAgICAgICB9LAogICAgICAgIFBhdXNlZCA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiUGF1c2VkIiwKICAgICAgICAgICAgS2V5YmluZCA9IEVudW0uS2V5Q29kZS5RCiAgICAgICAgfSwKICAgICAgICBLZXliaW5kc0VuYWJsZWQgPSB7CiAgICAgICAgICAgIFZhbHVlID0gdHJ1ZSwKICAgICAgICAgICAgTGFiZWwgPSAiS2V5YmluZHMgRW5hYmxlZCIKICAgICAgICB9LAogICAgICAgIEZpbmRTdHJpbmdGb3JOYW1lID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIkZpbmQgYXJnIGZvciBuYW1lIgogICAgICAgIH0sCiAgICAgICAgVWlWaXNpYmxlID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIlVJIFZpc2libGUiLAogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlAKICAgICAgICB9LAogICAgICAgIE5vVHJlZU5vZGVzID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBncm91cGluZyIKICAgICAgICB9LAogICAgICAgIFRhYmxlQXJncyA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiVGFibGUgYXJncyIKICAgICAgICB9LAogICAgICAgIE5vVmFyaWFibGVzID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBjb21wcmVzc2lvbiIKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFnVmFsdWUoTmFtZTogc3RyaW5nKTogRmxhZ1ZhbHVlCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpCiAgICByZXR1cm4gRmxhZy5WYWx1ZQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpTZXRGbGFnVmFsdWUoTmFtZTogc3RyaW5nLCBWYWx1ZTogRmxhZ1ZhbHVlKQogICAgbG9jYWwgRmxhZyA9IHNlbGY6R2V0RmxhZyhOYW1lKQogICAgRmxhZy5WYWx1ZSA9IFZhbHVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNldEZsYWdDYWxsYmFjayhOYW1lOiBzdHJpbmcsIENhbGxiYWNrOiAoLi4uYW55KSAtPiAuLi5hbnkpCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpCiAgICBGbGFnLkNhbGxiYWNrID0gQ2FsbGJhY2sKZW5kCgpmdW5jdGlvbiBNb2R1bGU6U2V0RmxhZ0NhbGxiYWNrcyhEaWN0OiB7fSkKICAgIGZvciBOYW1lLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55IGluIG5leHQsIERpY3QgZG8gCiAgICAgICAgc2VsZjpTZXRGbGFnQ2FsbGJhY2soTmFtZSwgQ2FsbGJhY2spCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0RmxhZyhOYW1lOiBzdHJpbmcpOiBGbGFnCiAgICBsb2NhbCBBbGxGbGFncyA9IHNlbGY6R2V0RmxhZ3MoKQogICAgbG9jYWwgRmxhZyA9IEFsbEZsYWdzW05hbWVdCiAgICBhc3NlcnQoRmxhZywgIkZsYWcgZG9lcyBub3QgZXhpc3QhIikKICAgIHJldHVybiBGbGFnCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkFkZEZsYWcoTmFtZTogc3RyaW5nLCBGbGFnOiBGbGFnKQogICAgbG9jYWwgQWxsRmxhZ3MgPSBzZWxmOkdldEZsYWdzKCkKICAgIEFsbEZsYWdzW05hbWVdID0gRmxhZwplbmQKCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFncygpOiBGbGFncwogICAgcmV0dXJuIHNlbGYuRmxhZ3MKZW5kCgpyZXR1cm4gTW9kdWxl"},
	Ui = {"base64", "bG9jYWwgVWkgPSB7CglEZWZhdWx0RWRpdG9yQ29udGVudCA9IFs9Wy0tW1sgCglXZWxjb21lIHRvIFNpZ21hIFNweQoJQ3JlYXRlZCBieSBkZXBzbyEKXV0gXT1dLAoJTG9nTGltaXQgPSAxMDAsCiAgICBTZWFzb25MYWJlbHMgPSB7IAogICAgICAgIEphbnVhcnkgPSAi4puEJXPim4QiLCAKICAgICAgICBGZWJydWFyeSA9ICLwn4yo77iPJXPwn4+CIiwgCiAgICAgICAgTWFyY2ggPSAi8J+MuSVz8J+MuiIsIAogICAgICAgIEFwcmlsID0gIvCfkKMlc+Kcne+4jyIsIAogICAgICAgIE1heSA9ICLwn5CdJXPwn4yeIiwgCiAgICAgICAgSnVuZSA9ICLwn4yyJXPwn6WVIiwgCiAgICAgICAgSnVseSA9ICLwn4yKJXPwn4yFIiwgCiAgICAgICAgQXVndXN0ID0gIuKYgO+4jyVz8J+MniIsIAogICAgICAgIFNlcHRlbWJlciA9ICLwn42BJXPwn42BIiwgCiAgICAgICAgT2N0b2JlciA9ICLwn46DJXPwn46DIiwgCiAgICAgICAgTm92ZW1iZXIgPSAi8J+NgiVz8J+NgiIsIAogICAgICAgIERlY2VtYmVyID0gIvCfjoQlc/CfjoEiCiAgICB9LAoJU2NhbGVzID0gewoJCVsiTW9iaWxlIl0gPSBVRGltMi5mcm9tT2Zmc2V0KDQ4MCwgMjgwKSwKCQlbIkRlc2t0b3AiXSA9IFVEaW0yLmZyb21PZmZzZXQoNjAwLCA0MDApLAoJfSwKICAgIEJhc2VDb25maWcgPSB7CiAgICAgICAgVGhlbWUgPSAiU2lnbWFTcHkiLAogICAgICAgIE5vU2Nyb2xsID0gdHJ1ZSwKICAgIH0sCglPcHRpb25UeXBlcyA9IHsKCQlib29sZWFuID0gIkNoZWNrYm94IiwKCX0sCglEaXNwbGF5UmVtb3RlSW5mbyA9IHsKCQkiTWV0YU1ldGhvZCIsCgkJIk1ldGhvZCIsCgkJIlJlbW90ZSIsCgkJIkNhbGxpbmdTY3JpcHQiLAoJCSJJc0FjdG9yIiwKCQkiSWQiCgl9LAoKICAgIFdpbmRvdyA9IG5pbCwKICAgIFJhbmRvbVNlZWQgPSBSYW5kb20ubmV3KHRpY2soKSksCglMb2dzID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gImsifSksCglMb2dRdWV1ZSA9IHNldG1ldGF0YWJsZSh7fSwge19fbW9kZSA9ICJ2In0pLAp9IAoKdHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBMb2cgPSB7CglSZW1vdGU6IEluc3RhbmNlLAoJTWV0aG9kOiBzdHJpbmcsCglBcmdzOiB0YWJsZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglNZXRhTWV0aG9kOiBzdHJpbmc/LAoJT3JpZ25hbEZ1bmM6ICgoLi4uYW55KSAtPiAuLi5hbnkpPywKCUNhbGxpbmdTY3JpcHQ6IEluc3RhbmNlPywKCUNhbGxpbmdGdW5jdGlvbjogKCguLi5hbnkpIC0+IC4uLmFueSk/LAoJQ2xhc3NEYXRhOiB0YWJsZT8sCglSZXR1cm5WYWx1ZXM6IHRhYmxlPywKCVJlbW90ZURhdGE6IHRhYmxlPywKCUlkOiBzdHJpbmcsCglTZWxlY3RhYmxlOiB0YWJsZSwKCUhlYWRlckRhdGE6IHRhYmxlLAoJVmFsdWVTd2FwczogdGFibGUsCglUaW1lc3RhbXA6IG51bWJlciwKCUlzRXhwbG9pdDogYm9vbGVhbgp9CgotLS8vIENvbXBhdGliaWxpdHkKbG9jYWwgU2V0Q2xpcGJvYXJkID0gc2V0Y2xpcGJvYXJkIG9yIHRvY2xpcGJvYXJkIG9yIHNldF9jbGlwYm9hcmQKCi0tLy8gTGlicmFyaWVzCmxvY2FsIFJlR3VpID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kZXB0aHNvL0RlYXItUmVHdWkvcmVmcy9oZWFkcy9tYWluL1JlR3VpLmx1YScpLCAiUmVHdWkiKSgpCgotLS8vIFNlcnZpY2VzCmxvY2FsIEluc2VydFNlcnZpY2U6IEluc2VydFNlcnZpY2UKCi0tLy8gTW9kdWxlcwpsb2NhbCBGbGFncwpsb2NhbCBHZW5lcmF0aW9uCmxvY2FsIFByb2Nlc3MKbG9jYWwgSG9vayAKbG9jYWwgQ29uZmlnCmxvY2FsIENvbW11bmljYXRpb24KbG9jYWwgRmlsZXMKCmxvY2FsIEFjdGl2ZURhdGEgPSBuaWwKbG9jYWwgUmVtb3Rlc0NvdW50ID0gMAoKbG9jYWwgVGV4dEZvbnQgPSBGb250LmZyb21FbnVtKEVudW0uRm9udC5Db2RlKQpsb2NhbCBGb250U3VjY2VzcyA9IGZhbHNlCmxvY2FsIENvbW1DaGFubmVsCgpmdW5jdGlvbiBVaTpJbml0KERhdGEpCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzCglsb2NhbCBTZXJ2aWNlcyA9IERhdGEuU2VydmljZXMKCgktLS8vIFNlcnZpY2VzCglJbnNlcnRTZXJ2aWNlID0gU2VydmljZXMuSW5zZXJ0U2VydmljZQoKCS0tLy8gTW9kdWxlcwoJRmxhZ3MgPSBNb2R1bGVzLkZsYWdzCglHZW5lcmF0aW9uID0gTW9kdWxlcy5HZW5lcmF0aW9uCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCglIb29rID0gTW9kdWxlcy5Ib29rCglDb25maWcgPSBNb2R1bGVzLkNvbmZpZwoJQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbgoJRmlsZXMgPSBNb2R1bGVzLkZpbGVzCgoJLS0vLyBSZUd1aQoJc2VsZjpDaGVja1NjYWxlKCkKCXNlbGY6TG9hZEZvbnQoKQoJc2VsZjpMb2FkUmVHdWkoKQplbmQKCmZ1bmN0aW9uIFVpOlNldENvbW1DaGFubmVsKE5ld0NvbW1DaGFubmVsOiBCaW5kYWJsZUV2ZW50KQoJQ29tbUNoYW5uZWwgPSBOZXdDb21tQ2hhbm5lbAplbmQKCmZ1bmN0aW9uIFVpOkNoZWNrU2NhbGUoKQoJbG9jYWwgQmFzZUNvbmZpZyA9IHNlbGYuQmFzZUNvbmZpZwoJbG9jYWwgU2NhbGVzID0gc2VsZi5TY2FsZXMKCglsb2NhbCBJc01vYmlsZSA9IFJlR3VpOklzTW9iaWxlRGV2aWNlKCkKCWxvY2FsIERldmljZSA9IElzTW9iaWxlIGFuZCAiTW9iaWxlIiBvciAiRGVza3RvcCIKCglCYXNlQ29uZmlnLlNpemUgPSBTY2FsZXNbRGV2aWNlXQplbmQKCmZ1bmN0aW9uIFVpOlNldENsaXBib2FyZChDb250ZW50OiBzdHJpbmcpCglTZXRDbGlwYm9hcmQoQ29udGVudCkKZW5kCgpmdW5jdGlvbiBVaTpUdXJuU2Vhc29uYWwoVGV4dDogc3RyaW5nKTogc3RyaW5nCiAgICBsb2NhbCBTZWFzb25MYWJlbHMgPSBzZWxmLlNlYXNvbkxhYmVscwogICAgbG9jYWwgTW9udGggPSBvcy5kYXRlKCIlQiIpCiAgICBsb2NhbCBCYXNlID0gU2Vhc29uTGFiZWxzW01vbnRoXQoKICAgIHJldHVybiBCYXNlOmZvcm1hdChUZXh0KQplbmQKCmZ1bmN0aW9uIFVpOkxvYWRGb250KCkKCWxvY2FsIEZvbnRGaWxlID0gc2VsZi5Gb250SnNvbkZpbGUKCgktLS8vIEdldCBGb250RmFjZSBBc3NldElkCglsb2NhbCBBc3NldElkID0gRmlsZXM6TG9hZEN1c3RvbWFzc2V0KEZvbnRGaWxlKQoJaWYgbm90IEFzc2V0SWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDcmVhdGUgY3VzdG9tIEZvbnRGYWNlCglsb2NhbCBOZXdGb250ID0gRm9udC5uZXcoQXNzZXRJZCkKCVRleHRGb250ID0gTmV3Rm9udAoJRm9udFN1Y2Nlc3MgPSB0cnVlCmVuZAoKZnVuY3Rpb24gVWk6U2V0Rm9udEZpbGUoRm9udEZpbGU6IHN0cmluZykKCXNlbGYuRm9udEpzb25GaWxlID0gRm9udEZpbGUKZW5kCgpmdW5jdGlvbiBVaTpGb250V2FzU3VjY2Vzc2Z1bCgpCglpZiBGb250U3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCgktLS8vIEVycm9yIG1lc3NhZ2UKCXNlbGY6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSB5b3VyIGV4ZWN1dG9yIHdhcyB1bmFibGUgdG8gZG93bmxvYWQgdGhlIGZvbnQgYW5kIHRoZXJlZm9yZSBzd2l0Y2hlZCB0byB0aGUgRGFyayB0aGVtZSIsCgkJIlxuSWYgeW91IHdvdWxkIGxpa2UgdG8gdXNlIHRoZSBJbUd1aSB0aGVtZSwgXG5wbGVhc2UgZG93bmxvYWQgdGhlIGZvbnQgKGFzc2V0cy9Qcm9nZ3lDbGVhbi50dGYpIiwKCQkiYW5kIHB1dCBwdXQgaXQgaW4geW91ciB3b3Jrc3BhY2UgZm9sZGVyXG4oU2lnbWEgU3B5L2Fzc2V0cykiCgl9KQplbmQKCmZ1bmN0aW9uIFVpOkxvYWRSZUd1aSgpCglsb2NhbCBUaGVtZUNvbmZpZyA9IENvbmZpZy5UaGVtZUNvbmZpZwoJVGhlbWVDb25maWcuVGV4dEZvbnQgPSBUZXh0Rm9udAoKCS0tLy8gUmVHdWkKCVJlR3VpOkRlZmluZVRoZW1lKCJTaWdtYVNweSIsIFRoZW1lQ29uZmlnKQplbmQKCnR5cGUgQ3JlYXRlQnV0dG9ucyA9IHsKCUJhc2U6IHRhYmxlPywKCUJ1dHRvbnM6IHRhYmxlLAoJTm9UYWJsZTogYm9vbGVhbj8KfQpmdW5jdGlvbiBVaTpDcmVhdGVCdXR0b25zKFBhcmVudCwgRGF0YTogQ3JlYXRlQnV0dG9ucykKCWxvY2FsIEJhc2UgPSBEYXRhLkJhc2Ugb3Ige30KCWxvY2FsIEJ1dHRvbnMgPSBEYXRhLkJ1dHRvbnMKCWxvY2FsIE5vVGFibGUgPSBEYXRhLk5vVGFibGUKCgktLS8vIENyZWF0ZSB0YWJsZSBsYXlvdXQKCWlmIG5vdCBOb1RhYmxlIHRoZW4KCQlQYXJlbnQgPSBQYXJlbnQ6VGFibGUoewoJCQlNYXhDb2x1bW5zID0gMwoJCX0pOk5leHRSb3coKQoJZW5kCgoJLS0vLyBDcmVhdGUgYnV0dG9ucwoJZm9yIF8sIEJ1dHRvbiBpbiBuZXh0LCBCdXR0b25zIGRvCgkJbG9jYWwgQ29udGFpbmVyID0gUGFyZW50CgkJaWYgbm90IE5vVGFibGUgdGhlbgoJCQlDb250YWluZXIgPSBQYXJlbnQ6TmV4dENvbHVtbigpCgkJZW5kCgoJCVJlR3VpOkNoZWNrQ29uZmlnKEJ1dHRvbiwgQmFzZSkKCQlDb250YWluZXI6QnV0dG9uKEJ1dHRvbikKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZVdpbmRvdyhPdmVyd3JpdGVzOiB0YWJsZSkKICAgIGxvY2FsIEJhc2VDb25maWcgPSBzZWxmLkJhc2VDb25maWcKCWxvY2FsIENvbmZpZyA9IFByb2Nlc3M6RGVlcENsb25lVGFibGUoQmFzZUNvbmZpZykKCgktLS8vIE1lcmdlIG92ZXJ3cml0ZXMKCWlmIE92ZXJ3cml0ZXMgdGhlbgoJCU1lcmdlKENvbmZpZywgT3ZlcndyaXRlcykKCWVuZAoJCgktLS8vIENyZWF0ZSBXaW5kb3cKCWxvY2FsIFdpbmRvdyA9IFJlR3VpOldpbmRvdyhDb25maWcpCgoJLS0vLyBTd2l0Y2ggdG8gRGFya1RoZW1lIGluc3RlYWQgb2YgdGhlIEltR3VpIHRoZW1lIGlmIHRoZSBmb250IGNhbm5vdCBiZSBsb2FkZWQKCWlmIG5vdCBGb250U3VjY2VzcyB0aGVuIAoJCVdpbmRvdzpTZXRUaGVtZSgiRGFya1RoZW1lIikKCWVuZAoJCgktLS8vIENyZWF0ZSBXaW5kb3cKCXJldHVybiBXaW5kb3cKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVNYWluV2luZG93KCkKCWxvY2FsIFdpbmRvdyA9IHNlbGY6Q3JlYXRlV2luZG93KCkKCXNlbGYuV2luZG93ID0gV2luZG93CgoJLS0vLyBDaGVjayBpZiB0aGUgZm9udCB3YXMgc3VjY2Vzc2Z1bGx5IGRvd25sb2FkZWQKCXNlbGY6Rm9udFdhc1N1Y2Nlc3NmdWwoKQoJc2VsZjpBdXJhQ291bnRlclNlcnZpY2UoKQoKCS0tLy8gVWlWaXNpYmxlIGZsYWcgY2FsbGJhY2sKCUZsYWdzOlNldEZsYWdDYWxsYmFjaygiVWlWaXNpYmxlIiwgZnVuY3Rpb24oc2VsZiwgVmlzaWJsZSkKCQlXaW5kb3c6U2V0VmlzaWJsZShWaXNpYmxlKQoJZW5kKQoKCXJldHVybiBXaW5kb3cKZW5kCgpmdW5jdGlvbiBVaTpTaG93TW9kYWwoTGluZXM6IHRhYmxlKQoJbG9jYWwgV2luZG93ID0gc2VsZi5XaW5kb3cKCWxvY2FsIE1lc3NhZ2UgPSB0YWJsZS5jb25jYXQoTGluZXMsICJcbiIpCgoJLS0vLyBNb2RhbCBXaW5kb3cKCWxvY2FsIE1vZGFsV2luZG93ID0gV2luZG93OlBvcHVwTW9kYWwoewoJCVRpdGxlID0gIlNpZ21hIFNweSIKCX0pCglNb2RhbFdpbmRvdzpMYWJlbCh7CgkJVGV4dCA9IE1lc3NhZ2UsCgkJUmljaFRleHQgPSB0cnVlLAoJCVRleHRXcmFwcGVkID0gdHJ1ZQoJfSkKCU1vZGFsV2luZG93OkJ1dHRvbih7CgkJVGV4dCA9ICJPa2F5IiwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJTW9kYWxXaW5kb3c6Q2xvc2VQb3B1cCgpCgkJZW5kLAoJfSkKZW5kCgpmdW5jdGlvbiBVaTpTaG93VW5zdXBwb3J0ZWRFeGVjdXRvcihOYW1lOiBzdHJpbmcpCglVaTpTaG93TW9kYWwoewoJCSJVbmZvcnR1bmF0ZWx5IFNpZ21hIFNweSBpcyBub3Qgc3VwcG9ydGVkIG9uIHlvdXIgZXhlY3V0b3IiLAoJCSJUaGUgYmVzdCBmcmVlIG9wdGlvbiBpcyBTd2lmdCAoZGlzY29yZC5nZy9nZXRzd2lmdGdnKSIsCgkJYFxuWW91ciBleGVjdXRvcjoge05hbWV9YAoJfSkKZW5kCgpmdW5jdGlvbiBVaTpTaG93VW5zdXBwb3J0ZWQoRnVuY05hbWU6IHN0cmluZykKCVVpOlNob3dNb2RhbCh7CgkJIlVuZm9ydHVuYXRlbHkgU2lnbWEgU3B5IGlzIG5vdCBzdXBwb3J0ZWQgb24geW91ciBleGVjdXRvciIsCgkJYFxuTWlzc2luZyBmdW5jdGlvbjoge0Z1bmNOYW1lfWAKCX0pCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlT3B0aW9uc0ZvckRpY3QoUGFyZW50LCBEaWN0OiB0YWJsZSwgQ2FsbGJhY2spCglsb2NhbCBPcHRpb25zID0ge30KCgktLS8vIERpY3RvbmFyeSB3cmFwCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBEaWN0IGRvCgkJT3B0aW9uc1tLZXldID0gewoJCQlWYWx1ZSA9IFZhbHVlLAoJCQlMYWJlbCA9IEtleSwKCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbihfLCBWYWx1ZSkKCQkJCURpY3RbS2V5XSA9IFZhbHVlCgoJCQkJLS0vLyBJbnZva2UgY2FsbGJhY2sKCQkJCWlmIG5vdCBDYWxsYmFjayB0aGVuIHJldHVybiBlbmQKCQkJCUNhbGxiYWNrKCkKCQkJZW5kCgkJfQoJZW5kCgoJLS0vLyBDcmVhdGUgZWxlbWVudHMKCXNlbGY6Q3JlYXRlRWxlbWVudHMoUGFyZW50LCBPcHRpb25zKQplbmQKCmZ1bmN0aW9uIFVpOkNoZWNrS2V5YmluZExheW91dChDb250YWluZXIsIEtleUNvZGU6IEVudW0uS2V5Q29kZSwgQ2FsbGJhY2spCglpZiBub3QgS2V5Q29kZSB0aGVuIHJldHVybiBDb250YWluZXIgZW5kCgoJLS0vLyBDcmVhdGUgUm93IGxheW91dAoJQ29udGFpbmVyID0gQ29udGFpbmVyOlJvdyh7CgkJSG9yaXpvbnRhbEZsZXggPSBFbnVtLlVJRmxleEFsaWdubWVudC5TcGFjZUJldHdlZW4KCX0pCgoJLS0vLyBBZGQgS2V5YmluZCBlbGVtZW50CglDb250YWluZXI6S2V5YmluZCh7CgkJTGFiZWwgPSAiIiwKCQlWYWx1ZSA9IEtleUNvZGUsCgkJTGF5b3V0T3JkZXIgPSAyLAoJCUlnbm9yZUdhbWVQcm9jZXNzZWQgPSBmYWxzZSwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJLS0vLyBDaGVjayBpZiBrZXliaW5kcyBhcmUgZW5hYmxlZAoJCQlsb2NhbCBFbmFibGVkID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJLZXliaW5kc0VuYWJsZWQiKQoJCQlpZiBub3QgRW5hYmxlZCB0aGVuIHJldHVybiBlbmQKCgkJCS0tLy8gSW52b2tlIGNhbGxiYWNrCgkJCUNhbGxiYWNrKCkKCQllbmQsCgl9KQoKCXJldHVybiBDb250YWluZXIKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVFbGVtZW50cyhQYXJlbnQsIE9wdGlvbnMpCglsb2NhbCBPcHRpb25UeXBlcyA9IHNlbGYuT3B0aW9uVHlwZXMKCQoJLS0vLyBDcmVhdGUgdGFibGUgbGF5b3V0Cglsb2NhbCBUYWJsZSA9IFBhcmVudDpUYWJsZSh7CgkJTWF4Q29sdW1ucyA9IDMKCX0pOk5leHRSb3coKQoKCWZvciBOYW1lLCBEYXRhIGluIE9wdGlvbnMgZG8KCQlsb2NhbCBWYWx1ZSA9IERhdGEuVmFsdWUKCQlsb2NhbCBUeXBlID0gdHlwZW9mKFZhbHVlKQoKCQktLS8vIEFkZCBtaXNzaW5nIHZhbHVlcyBpbnRvIG9wdGlvbnMgdGFibGUKCQlSZUd1aTpDaGVja0NvbmZpZyhEYXRhLCB7CgkJCUNsYXNzID0gT3B0aW9uVHlwZXNbVHlwZV0sCgkJCUxhYmVsID0gTmFtZSwKCQl9KQoJCQoJCS0tLy8gQ2hlY2sgaWYgYSBlbGVtZW50IHR5cGUgZXhpc3RzIGZvciB2YWx1ZSB0eXBlCgkJbG9jYWwgQ2xhc3MgPSBEYXRhLkNsYXNzCgkJYXNzZXJ0KENsYXNzLCBgTm8ge1R5cGV9IHR5cGUgZXhpc3RzIGZvciBvcHRpb25gKQoKCQlsb2NhbCBDb250YWluZXIgPSBUYWJsZTpOZXh0Q29sdW1uKCkKCQlsb2NhbCBDaGVja2JveCA9IG5pbAoKCQktLS8vIENoZWNrIGZvciBhIGtleWJpbmQgbGF5b3V0CgkJbG9jYWwgS2V5YmluZCA9IERhdGEuS2V5YmluZAoJCUNvbnRhaW5lciA9IHNlbGY6Q2hlY2tLZXliaW5kTGF5b3V0KENvbnRhaW5lciwgS2V5YmluZCwgZnVuY3Rpb24oKQoJCQlDaGVja2JveDpUb2dnbGUoKQoJCWVuZCkKCQkKCQktLS8vIENyZWF0ZSBjb2x1bW4gYW5kIGVsZW1lbnQKCQlDaGVja2JveCA9IENvbnRhaW5lcltDbGFzc10oQ29udGFpbmVyLCBEYXRhKQoJZW5kCmVuZAoKLS0vLyBCb2lpaWkgd2hhdCBkaWQgeW91IHNheSBhYm91dCBTaWdtYSBTcHkg8J+SgPCfkoAKZnVuY3Rpb24gVWk6RGlzcGxheUF1cmEoKQogICAgbG9jYWwgV2luZG93ID0gc2VsZi5XaW5kb3cKICAgIGxvY2FsIFJhbmQgPSBzZWxmLlJhbmRvbVNlZWQKCgktLS8vIEF1cmEgKGJvaWlpaWkpCiAgICBsb2NhbCBBVVJBID0gUmFuZDpOZXh0SW50ZWdlcigxLCA5OTk5OTk5KQogICAgbG9jYWwgQVVSQURFTEFZID0gUmFuZDpOZXh0SW50ZWdlcigxLCA1KQoKCS0tLy8gVGl0bGUKCWxvY2FsIFRpdGxlID0gYCBTaWdtYSBTcHkgLSBEZXBzbyB8IEFVUkE6IHtBVVJBfSBgCglsb2NhbCBTZWFzb25hbCA9IHNlbGY6VHVyblNlYXNvbmFsKFRpdGxlKQogICAgV2luZG93OlNldFRpdGxlKFNlYXNvbmFsKQoKICAgIHdhaXQoQVVSQURFTEFZKQplbmQKCmZ1bmN0aW9uIFVpOkF1cmFDb3VudGVyU2VydmljZSgpCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgIHNlbGY6RGlzcGxheUF1cmEoKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZVdpbmRvd0NvbnRlbnQoV2luZG93KQogICAgLS0vLyBXaW5kb3cgZ3JvdXAKICAgIGxvY2FsIExheW91dCA9IFdpbmRvdzpMaXN0KHsKICAgICAgICBVaVBhZGRpbmcgPSAyLAogICAgICAgIEhvcml6b250YWxGbGV4ID0gRW51bS5VSUZsZXhBbGlnbm1lbnQuRmlsbCwKICAgICAgICBWZXJ0aWNhbEZsZXggPSBFbnVtLlVJRmxleEFsaWdubWVudC5GaWxsLAogICAgICAgIEZpbGxEaXJlY3Rpb24gPSBFbnVtLkZpbGxEaXJlY3Rpb24uVmVydGljYWwsCiAgICAgICAgRmlsbCA9IHRydWUKICAgIH0pCgoJLS0vLyBSZW1vdGVzIGxpc3QKICAgIHNlbGYuUmVtb3Rlc0xpc3QgPSBMYXlvdXQ6Q2FudmFzKHsKICAgICAgICBTY3JvbGwgPSB0cnVlLAogICAgICAgIFVpUGFkZGluZyA9IDUsCiAgICAgICAgQXV0b21hdGljU2l6ZSA9IEVudW0uQXV0b21hdGljU2l6ZS5Ob25lLAogICAgICAgIEZsZXhNb2RlID0gRW51bS5VSUZsZXhNb2RlLk5vbmUsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMzAsIDEsIDApCiAgICB9KQoKCS0tLy8gVGFiIGJveAoJbG9jYWwgSW5mb1NlbGVjdG9yID0gTGF5b3V0OlRhYlNlbGVjdG9yKHsKICAgICAgICBOb0FuaW1hdGlvbiA9IHRydWUsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtMTMwLCAwLjQsIDApLAogICAgfSkKCglzZWxmLkluZm9TZWxlY3RvciA9IEluZm9TZWxlY3RvcgoJc2VsZi5DYW52YXNMYXlvdXQgPSBMYXlvdXQKCgktLS8vIE1ha2UgdGFicwoJc2VsZjpNYWtlRWRpdG9yVGFiKEluZm9TZWxlY3RvcikKCXNlbGY6TWFrZU9wdGlvbnNUYWIoSW5mb1NlbGVjdG9yKQplbmQKCmZ1bmN0aW9uIFVpOk1ha2VPcHRpb25zVGFiKEluZm9TZWxlY3RvcikKCS0tLy8gVGFiU2VsZWN0b3IKCWxvY2FsIE9wdGlvbnNUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gIk9wdGlvbnMiCgl9KQoKCS0tLy8gQWRkIGdsb2JhbCBvcHRpb25zCglPcHRpb25zVGFiOlNlcGFyYXRvcih7VGV4dD0iTG9ncyJ9KQoJc2VsZjpDcmVhdGVCdXR0b25zKE9wdGlvbnNUYWIsIHsKCQlCYXNlID0gewoJCQlTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDIwKSwKCQkJQXV0b21hdGljU2l6ZSA9IEVudW0uQXV0b21hdGljU2l6ZS5ZLAoJCX0sCgkJQnV0dG9ucyA9IHsKCQkJewoJCQkJVGV4dCA9ICJDbGVhciBsb2dzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFRhYiA9IEFjdGl2ZURhdGEgYW5kIEFjdGl2ZURhdGEuVGFiIG9yIG5pbAoKCQkJCQktLS8vIFJlbW92ZSB0aGUgUmVtb3RlIHRhYgoJCQkJCWlmIFRhYiB0aGVuCgkJCQkJCUluZm9TZWxlY3RvcjpSZW1vdmVUYWIoVGFiKQoJCQkJCWVuZAoKCQkJCQktLS8vIENsZWFyIGFsbCBsb2cgZWxlbWVudHMKCQkJCQlBY3RpdmVEYXRhID0gbmlsCgkJCQkJc2VsZjpDbGVhckxvZ3MoKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGJsb2NrcyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlQcm9jZXNzOlVwZGF0ZUFsbFJlbW90ZURhdGEoIkJsb2NrZWQiLCBmYWxzZSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJDbGVhciBleGNsdWRlcyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlQcm9jZXNzOlVwZGF0ZUFsbFJlbW90ZURhdGEoIkV4Y2x1ZGVkIiwgZmFsc2UpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ29weSBEaXNjb3JkIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCXNlbGY6U2V0Q2xpcGJvYXJkKCJodHRwczovL2Rpc2NvcmQuZ2cvczluZ21VRFdnYiIpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ29weSBHaXRodWIiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJc2VsZjpTZXRDbGlwYm9hcmQoImh0dHBzOi8vZ2l0aHViLmNvbS9kZXB0aHNvL1NpZ21hLVNweSIpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiRWRpdCBTcG9vZnMiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJc2VsZjpFZGl0RmlsZSgiUmV0dXJuIHNwb29mcy5sdWEiLCB0cnVlLCBmdW5jdGlvbihXaW5kb3csIENvbnRlbnQ6IHN0cmluZykKCQkJCQkJV2luZG93OkNsb3NlKCkKCQkJCQkJQ29tbUNoYW5uZWw6RmlyZSgiVXBkYXRlU3Bvb2ZzIiwgQ29udGVudCkKCQkJCQllbmQpCgkJCQllbmQsCgkJCX0KCQl9Cgl9KQoKCS0tLy8gRmxhZyBvcHRpb25zCglPcHRpb25zVGFiOlNlcGFyYXRvcih7VGV4dD0iU2V0dGluZ3MifSkKCXNlbGY6Q3JlYXRlRWxlbWVudHMoT3B0aW9uc1RhYiwgRmxhZ3M6R2V0RmxhZ3MoKSkKCglzZWxmOkFkZERldGFpbHNTZWN0aW9uKE9wdGlvbnNUYWIpCmVuZAoKZnVuY3Rpb24gVWk6QWRkRGV0YWlsc1NlY3Rpb24oT3B0aW9uc1RhYikKCU9wdGlvbnNUYWI6U2VwYXJhdG9yKHtUZXh0PSJJbmZvcm1hdGlvbiJ9KQoJT3B0aW9uc1RhYjpCdWxsZXRUZXh0KHsKCQlSb3dzID0gewoJCQkiU2lnbWEgc3B5IC0gV3JpdHRlbiBieSBkZXBzbyEiLAoJCQkiTGlicmFyaWVzOiBSb2Jsb3gtUGFyc2VyLCBEZWFyLVJlR3VpIiwKCQkJIlRoYW5rIHlvdSB0byBzeW4gZm9yIHlvdXIgc3VnZ2VzdGlvbnMgYW5kIHRlc3RpbmciCgkJfQoJfSkKZW5kCgpsb2NhbCBmdW5jdGlvbiBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKE5hbWU6IHN0cmluZykKCXJldHVybiBmdW5jdGlvbiguLi4pCgkJaWYgbm90IEFjdGl2ZURhdGEgdGhlbiByZXR1cm4gZW5kCgkJcmV0dXJuIEFjdGl2ZURhdGFbTmFtZV0oQWN0aXZlRGF0YSwgLi4uKQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6TWFrZUVkaXRvclRhYihJbmZvU2VsZWN0b3IpCglsb2NhbCBEZWZhdWx0ID0gc2VsZi5EZWZhdWx0RWRpdG9yQ29udGVudAoJbG9jYWwgV2luZG93ID0gc2VsZi5XaW5kb3cKCglsb2NhbCBTeW50YXhDb2xvcnMgPSBDb25maWcuU3ludGF4Q29sb3JzCgoJLS0vLyBDcmVhdGUgdGFiCglsb2NhbCBFZGl0b3JUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gIkVkaXRvciIKCX0pCgoJLS0vLyBJREUKCWxvY2FsIENvZGVFZGl0b3IgPSBFZGl0b3JUYWI6Q29kZUVkaXRvcih7CgkJRmlsbCA9IHRydWUsCgkJRWRpdGFibGUgPSB0cnVlLAoJCUZvbnRTaXplID0gMTMsCgkJQ29sb3JzID0gU3ludGF4Q29sb3JzLAoJCUZvbnRGYWNlID0gVGV4dEZvbnQsCgkJVGV4dCA9IERlZmF1bHQKCX0pCgoJLS0vLyBCdXR0b25zCglsb2NhbCBCdXR0b25zUm93ID0gRWRpdG9yVGFiOlJvdygpCglzZWxmOkNyZWF0ZUJ1dHRvbnMoQnV0dG9uc1JvdywgewoJCU5vVGFibGUgPSB0cnVlLAoJCUJ1dHRvbnMgPSB7CgkJCXsKCQkJCVRleHQgPSAiQ29weSIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJCXNlbGY6U2V0Q2xpcGJvYXJkKFNjcmlwdCkKCQkJCWVuZAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlJ1biIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJCWxvY2FsIEZ1bmMsIEVycm9yID0gbG9hZHN0cmluZyhTY3JpcHQsICJTaWdtYVNweS1VU0VSU0NSSVBUIikKCgkJCQkJLS0vLyBTeW50YXggY2hlY2sKCQkJCQlpZiBub3QgRnVuYyB0aGVuCgkJCQkJCXNlbGY6U2hvd01vZGFsKHsiRXJyb3IgcnVubmluZyBzY3JpcHQhXG4iLCBFcnJvcn0pCgkJCQkJCXJldHVybgoJCQkJCWVuZAoKCQkJCQlGdW5jKCkKCQkJCWVuZAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkdldCByZXR1cm4iLAoJCQkJQ2FsbGJhY2sgPSBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKCJHZXRSZXR1cm4iKQoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlNjcmlwdCIsCgkJCQlDYWxsYmFjayA9IE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soIlNjcmlwdE9wdGlvbnMiKQoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkJ1aWxkIiwKCQkJCUNhbGxiYWNrID0gTWFrZUFjdGl2ZURhdGFDYWxsYmFjaygiQnVpbGRTY3JpcHQiKQoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlBvcC1vdXQiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCQlsb2NhbCBUaWxlID0gQWN0aXZlRGF0YSBhbmQgQWN0aXZlRGF0YS5UYXNrIG9yICJTaWdtYSBTcHkiCgkJCQkJc2VsZjpNYWtlRWRpdG9yUG9wb3V0V2luZG93KFNjcmlwdCwgewoJCQkJCQlUaXRsZSA9IFRpbGUKCQkJCQl9KQoJCQkJZW5kCgkJCX0sCgkJfQoJfSkKCQoJc2VsZi5Db2RlRWRpdG9yID0gQ29kZUVkaXRvcgplbmQKCmZ1bmN0aW9uIFVpOlNob3VsZEZvY3VzKFRhYik6IGJvb2xlYW4KCWxvY2FsIEluZm9TZWxlY3RvciA9IHNlbGYuSW5mb1NlbGVjdG9yCglsb2NhbCBBY3RpdmVUYWIgPSBJbmZvU2VsZWN0b3IuQWN0aXZlVGFiCgoJLS0vLyBJZiB0aGVyZSBpcyBhbiBlbXB0eSB0YWIKCWlmIG5vdCBBY3RpdmVUYWIgdGhlbgoJCXJldHVybiB0cnVlCgllbmQKCglyZXR1cm4gSW5mb1NlbGVjdG9yOkNvbXBhcmVUYWJzKEFjdGl2ZVRhYiwgVGFiKQplbmQKCmZ1bmN0aW9uIFVpOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coQ29udGVudDogc3RyaW5nLCBXaW5kb3dDb25maWc6IHRhYmxlKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coV2luZG93Q29uZmlnKQoJbG9jYWwgQnV0dG9ucyA9IFdpbmRvd0NvbmZpZy5CdXR0b25zIG9yIHt9CgoJbG9jYWwgQ29kZUVkaXRvciA9IFdpbmRvdzpDb2RlRWRpdG9yKHsKCQlUZXh0ID0gQ29udGVudCwKCQlFZGl0YWJsZSA9IHRydWUsCgkJRmlsbCA9IHRydWUsCgkJRm9udFNpemUgPSAxMywKCQlDb2xvcnMgPSBTeW50YXhDb2xvcnMsCgkJRm9udEZhY2UgPSBUZXh0Rm9udAoJfSkKCgktLS8vIERlZmF1bHQgYnV0dG9ucwoJdGFibGUuaW5zZXJ0KEJ1dHRvbnMsIHsKCQlUZXh0ID0gIkNvcHkiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQlzZWxmOlNldENsaXBib2FyZChTY3JpcHQpCgkJZW5kCgl9KQoKCS0tLy8gQnV0dG9ucwoJbG9jYWwgQnV0dG9uc1JvdyA9IFdpbmRvdzpSb3coKQoJc2VsZjpDcmVhdGVCdXR0b25zKEJ1dHRvbnNSb3csIHsKCQlOb1RhYmxlID0gdHJ1ZSwKCQlCdXR0b25zID0gQnV0dG9ucwoJfSkKCglXaW5kb3c6Q2VudGVyKCkKCXJldHVybiBDb2RlRWRpdG9yCmVuZAoKZnVuY3Rpb24gVWk6RWRpdEZpbGUoRmlsZVBhdGg6IHN0cmluZywgSW5Gb2xkZXI6IGJvb2xlYW4sIE9uU2F2ZUZ1bmM6ICgodGFibGUsIHN0cmluZykgLT4gbmlsKT8pCglsb2NhbCBGb2xkZXIgPSBGaWxlcy5Gb2xkZXJOYW1lCgoJLS0vLyBSZWxhdGl2ZSB0byBTaWdtYSBTcHkgZm9sZGVyCglpZiBJbkZvbGRlciB0aGVuCgkJRmlsZVBhdGggPSBge0ZvbGRlcn0ve0ZpbGVQYXRofWAKCWVuZAoKCS0tLy8gR2V0IGZpbGUgY29udGVudAoJbG9jYWwgQ29udGVudCA9IHJlYWRmaWxlKEZpbGVQYXRoKQoJQ29udGVudCA9IENvbnRlbnQ6Z3N1YigiXHJcbiIsICJcbiIpCgoJbG9jYWwgQ29kZUVkaXRvcgoJbG9jYWwgQnV0dG9ucyA9IHsKCQl7CgkJCVRleHQgPSAiU2F2ZSIsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCWxvY2FsIFN1Y2Nlc3MsIEVycm9yID0gbG9hZHN0cmluZyhTY3JpcHQsICJTaWdtYVNweS1FZGl0b3IiKQoKCQkJCS0tLy8gU3ludGF4IGNoZWNrCgkJCQlpZiBub3QgU3VjY2VzcyB0aGVuCgkJCQkJc2VsZjpTaG93TW9kYWwoeyJFcnJvciBzYXZpbmcgZmlsZSFcbiIsIEVycm9yfSkKCQkJCQlyZXR1cm4KCQkJCWVuZAoJCQkJCgkJCQktLS8vIFNhdmUgY29udGVudHMKCQkJCXdyaXRlZmlsZShGaWxlUGF0aCwgU2NyaXB0KQoKCQkJCS0tLy8gSW52b2tlIG9uIHNhdmUgZnVuY3Rpb24KCQkJCWlmIE9uU2F2ZUZ1bmMgdGhlbgoJCQkJCU9uU2F2ZUZ1bmMoV2luZG93LCBTY3JpcHQpCgkJCQllbmQKCQkJZW5kCgkJfQoJfQoKCS0tLy8gQ3JlYXRlIEVkaXRvciBXaW5kb3cKCUNvZGVFZGl0b3IgPSBzZWxmOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coQ29udGVudCwgewoJCVRpdGxlID0gYEVkaXRpbmc6IHtGaWxlUGF0aH1gLAoJCUJ1dHRvbnMgPSBCdXR0b25zCgl9KQplbmQKCnR5cGUgTWVudU9wdGlvbnMgPSB7Cglbc3RyaW5nXTogKEd1aUJ1dHRvbiwgLi4uYW55KSAtPiBuaWwKfQpmdW5jdGlvbiBVaTpNYWtlQnV0dG9uTWVudShCdXR0b246IEluc3RhbmNlLCBVbnBhY2s6IHRhYmxlLCBPcHRpb25zOiBNZW51T3B0aW9ucykKCWxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93Cglsb2NhbCBQb3B1cCA9IFdpbmRvdzpQb3B1cENhbnZhcyh7CgkJUmVsYXRpdmVUbyA9IEJ1dHRvbiwKCQlNYXhTaXplWCA9IDUwMCwKCX0pCgoJLS0vLyBDcmVhdGUgU2VsZWN0YWJsZXMgZm9yIHN0cmluZywgZnVuY3Rpb24KCWZvciBOYW1lLCBGdW5jIGluIE9wdGlvbnMgZG8KCQkgUG9wdXA6U2VsZWN0YWJsZSh7CgkJCVRleHQgPSBOYW1lLAoJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCUZ1bmMoUHJvY2VzczpVbnBhY2soVW5wYWNrKSkKCQkJZW5kLAoJCX0pCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpSZW1vdmVQcmV2aW91c1RhYihUaXRsZTogc3RyaW5nKTogYm9vbGVhbgoJLS0vLyBObyBwcmV2aW91cyB0YWJzCglpZiBub3QgQWN0aXZlRGF0YSB0aGVuIAoJCXJldHVybiBmYWxzZSAKCWVuZAoKCS0tLy8gVGFiU2VsZWN0b3IKCWxvY2FsIEluZm9TZWxlY3RvciA9IHNlbGYuSW5mb1NlbGVjdG9yCgoJLS0vLyBQcmV2aW91cyBlbGVtZW50cwoJbG9jYWwgUHJldmlvdXNUYWIgPSBBY3RpdmVEYXRhLlRhYgoJbG9jYWwgUHJldmlvdXNTZWxlY3RhYmxlID0gQWN0aXZlRGF0YS5TZWxlY3RhYmxlCgoJLS0vLyBSZW1vdmUgcHJldmlvdXMgdGFiIGFuZCBzZXQgc2VsZWN0YWJsZSBmb2N1cwoJbG9jYWwgVGFiRm9jdXNlZCA9IHNlbGY6U2hvdWxkRm9jdXMoUHJldmlvdXNUYWIpCglJbmZvU2VsZWN0b3I6UmVtb3ZlVGFiKFByZXZpb3VzVGFiKQoJUHJldmlvdXNTZWxlY3RhYmxlOlNldFNlbGVjdGVkKGZhbHNlKQoKCS0tLy8gQ3JlYXRlIG5ldyB0YWIKCXJldHVybiBUYWJGb2N1c2VkCmVuZAoKZnVuY3Rpb24gVWk6TWFrZVRhYmxlSGVhZGVycyhUYWJsZSwgUm93czogdGFibGUpCglsb2NhbCBIZWFkZXJSb3cgPSBUYWJsZTpIZWFkZXJSb3coKQoJZm9yIF8sIENhdGFnb3J5IGluIFJvd3MgZG8KCQlsb2NhbCBDb2x1bW4gPSBIZWFkZXJSb3c6TmV4dENvbHVtbigpCgkJQ29sdW1uOkxhYmVsKHtUZXh0PUNhdGFnb3J5fSkKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOkRlY29tcGlsZShFZGl0b3I6IHRhYmxlLCBTY3JpcHQ6IHNjcmlwdCkKCWxvY2FsIEhlYWRlciA9ICItLUJPT0lJSUkgVEhJUyBJUyBTTyBUVUZGIEZMSVBQWSBTS0lCSURJIEFVUkEgKFNJR01BIFNQWSkiCglFZGl0b3I6U2V0VGV4dCgiLS1EZWNvbXBpbGluZy4uLiArOTk5OTk5OSBBVVJBIChtYW5nbyBwaG9uaykiKQoKCS0tLy8gRGVjb21waWxlIHNjcmlwdAoJbG9jYWwgRGVjb21waWxlZCwgSXNFcnJvciA9IFByb2Nlc3M6RGVjb21waWxlKFNjcmlwdCkKCgktLS8vIEFkZCBoZWFkZXIgZm9yIHN1Y2Nlc3NmdWwgZGVjb21waWxhdGlvbnMKCWlmIG5vdCBJc0Vycm9yIHRoZW4KCQlEZWNvbXBpbGVkID0gYHtIZWFkZXJ9XG57RGVjb21waWxlZH1gCgllbmQKCglFZGl0b3I6U2V0VGV4dChEZWNvbXBpbGVkKQplbmQKCnR5cGUgRGlzcGxheVRhYmxlQ29uZmlnID0gewoJUm93czogdGFibGUsCglGbGFnczogdGFibGU/LAoJVG9EaXNwbGF5OiB0YWJsZSwKCVRhYmxlOiB0YWJsZQp9CmZ1bmN0aW9uIFVpOkRpc3BsYXlUYWJsZShQYXJlbnQsIENvbmZpZzogRGlzcGxheVRhYmxlQ29uZmlnKTogdGFibGUKCS0tLy8gQ29uZmlndXJhdGlvbgoJbG9jYWwgUm93cyA9IENvbmZpZy5Sb3dzCglsb2NhbCBGbGFncyA9IENvbmZpZy5GbGFncwoJbG9jYWwgRGF0YVRhYmxlID0gQ29uZmlnLlRhYmxlCglsb2NhbCBUb0Rpc3BsYXkgPSBDb25maWcuVG9EaXNwbGF5CgoJRmxhZ3MuTWF4Q29sdW1ucyA9ICNSb3dzCgoJLS0vLyBDcmVhdGUgdGFibGUKCWxvY2FsIFRhYmxlID0gUGFyZW50OlRhYmxlKEZsYWdzKQoKCS0tLy8gVGFibGUgaGVhZGVycwoJc2VsZjpNYWtlVGFibGVIZWFkZXJzKFRhYmxlLCBSb3dzKQoKCS0tLy8gVGFibGUgbGF5b3V0Cglmb3IgUm93SW5kZXgsIE5hbWUgaW4gVG9EaXNwbGF5IGRvCgkJbG9jYWwgUm93ID0gVGFibGU6Um93KCkKCQkKCQktLS8vIENyZWF0ZSBDb2x1bW5zCgkJZm9yIENvdW50LCBDYXRhZ29yeSBpbiBSb3dzIGRvCgkJCWxvY2FsIENvbHVtbiA9IFJvdzpOZXh0Q29sdW1uKCkKCQkJCgkJCS0tLy8gVmFsdWUgdGV4dAoJCQlsb2NhbCBWYWx1ZSA9IENhdGFnb3J5ID09ICJOYW1lIiBhbmQgTmFtZSBvciBEYXRhVGFibGVbTmFtZV0KCQkJaWYgbm90IFZhbHVlIHRoZW4gY29udGludWUgZW5kCgoJCQktLS8vIENyZWF0ZSBmaWx0ZXJlZCBsYWJlbAoJCQlsb2NhbCBTdHJpbmcgPSBzZWxmOkZpbHRlck5hbWUoYHtWYWx1ZX1gLCAxNTApCgkJCUNvbHVtbjpMYWJlbCh7VGV4dD1TdHJpbmd9KQoJCWVuZAoJZW5kCgoJcmV0dXJuIFRhYmxlCmVuZAoKZnVuY3Rpb24gVWk6U2V0Rm9jdXNlZFJlbW90ZShEYXRhKQoJLS0vLyBVbnBhY2sgcmVtb3RlIGRhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAoJbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCWxvY2FsIFNjcmlwdCA9IERhdGEuQ2FsbGluZ1NjcmlwdAoJbG9jYWwgU291cmNlU2NyaXB0ID0gRGF0YS5Tb3VyY2VTY3JpcHQKCWxvY2FsIENsYXNzRGF0YSA9IERhdGEuQ2xhc3NEYXRhCglsb2NhbCBIZWFkZXJEYXRhID0gRGF0YS5IZWFkZXJEYXRhCglsb2NhbCBWYWx1ZVN3YXBzID0gRGF0YS5WYWx1ZVN3YXBzCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCglsb2NhbCBJZCA9IERhdGEuSWQKCgktLS8vIEZsYWdzCglsb2NhbCBUYWJsZUFyZ3MgPSBGbGFnczpHZXRGbGFnVmFsdWUoIlRhYmxlQXJncyIpCglsb2NhbCBOb1ZhcmlhYmxlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTm9WYXJpYWJsZXMiKQoKCS0tLy8gVW5wYWNrIGluZm8KCWxvY2FsIFJlbW90ZURhdGEgPSBQcm9jZXNzOkdldFJlbW90ZURhdGEoSWQpCglsb2NhbCBJc1JlbW90ZUZ1bmN0aW9uID0gQ2xhc3NEYXRhLklzUmVtb3RlRnVuY3Rpb24KCWxvY2FsIFJlbW90ZU5hbWUgPSBzZWxmOkZpbHRlck5hbWUoYHtSZW1vdGV9YCwgNTApCgoJLS0vLyBVSSBkYXRhCglsb2NhbCBDb2RlRWRpdG9yID0gc2VsZi5Db2RlRWRpdG9yCglsb2NhbCBUb0Rpc3BsYXkgPSBzZWxmLkRpc3BsYXlSZW1vdGVJbmZvCglsb2NhbCBJbmZvU2VsZWN0b3IgPSBzZWxmLkluZm9TZWxlY3RvcgoKCWxvY2FsIFRhYkZvY3VzZWQgPSBzZWxmOlJlbW92ZVByZXZpb3VzVGFiKCkKCWxvY2FsIFRhYiA9IEluZm9TZWxlY3RvcjpDcmVhdGVUYWIoewoJCU5hbWUgPSBzZWxmOkZpbHRlck5hbWUoYFJlbW90ZToge1JlbW90ZU5hbWV9YCwgNTApLAoJCUZvY3VzZWQgPSBUYWJGb2N1c2VkCgl9KQoKCS0tLy8gQ3JlYXRlIG5ldyBwYXJzZXIKCWxvY2FsIE1vZHVsZSA9IEdlbmVyYXRpb246TmV3UGFyc2VyKHsKCQlOb1ZhcmlhYmxlcyA9IE5vVmFyaWFibGVzCgl9KQoJbG9jYWwgUGFyc2VyID0gTW9kdWxlLlBhcnNlcgoJbG9jYWwgRm9ybWF0dGVyID0gTW9kdWxlLkZvcm1hdHRlcgoJRm9ybWF0dGVyOlNldFZhbHVlU3dhcHMoVmFsdWVTd2FwcykKCgktLS8vIFNldCB0aGlzIGxvZyB0byBiZSBzZWxlY3RlZAoJQWN0aXZlRGF0YSA9IERhdGEKCURhdGEuVGFiID0gVGFiCglEYXRhLlNlbGVjdGFibGU6U2V0U2VsZWN0ZWQodHJ1ZSkKCglsb2NhbCBmdW5jdGlvbiBTZXRJREVUZXh0KENvbnRlbnQ6IHN0cmluZywgVGFzazogc3RyaW5nKQoJCURhdGEuVGFzayA9IFRhc2sgb3IgIlNpZ21hIFNweSIKCQlDb2RlRWRpdG9yOlNldFRleHQoQ29udGVudCkKCWVuZAoJbG9jYWwgZnVuY3Rpb24gRGF0YUNvbm5lY3Rpb24oTmFtZSwgLi4uKQoJCWxvY2FsIEFyZ3MgPSB7Li4ufQoJCXJldHVybiBmdW5jdGlvbigpCgkJCXJldHVybiBEYXRhW05hbWVdKERhdGEsIFByb2Nlc3M6VW5wYWNrKEFyZ3MpKQoJCWVuZAoJZW5kCglsb2NhbCBmdW5jdGlvbiBTY3JpcHRDaGVjayhTY3JpcHQsIE5vTWlzc2luZ0NoZWNrOiBib29sZWFuKTogYm9vbGVhbgoJCS0tLy8gUmVqZWN0IGNsaWVudCBldmVudHMKCQlpZiBJc1JlY2VpdmUgdGhlbiAKCQkJVWk6U2hvd01vZGFsKHsKCQkJCSJSZWNpZXZlcyBkbyBub3QgaGF2ZSBhIHNjcmlwdCBiZWNhdXNlIGl0J3MgYSBDb25uZWN0aW9uIgoJCQl9KQoJCQlyZXR1cm4gCgkJZW5kCgoJCS0tLy8gQ2hlY2sgaWYgc2NyaXB0IGV4aXN0cwoJCWlmIG5vdCBTY3JpcHQgYW5kIG5vdCBOb01pc3NpbmdDaGVjayB0aGVuIAoJCQlVaTpTaG93TW9kYWwoeyJUaGUgU2NyaXB0IGhhcyBiZWVuIGRlc3Ryb3llZCBieSB0aGUgZ2FtZSAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgoJCXJldHVybiB0cnVlCgllbmQKCgktLS8vIEZ1bmN0aW9ucwoJZnVuY3Rpb24gRGF0YTpTY3JpcHRPcHRpb25zKEJ1dHRvbjogR3VpQnV0dG9uKQoJCVVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbiwge3NlbGZ9LCB7CgkJCVsiQ2FsbGVyIEluZm8iXSA9IERhdGFDb25uZWN0aW9uKCJHZW5lcmF0ZUluZm8iKSwKCQkJWyJEZWNvbXBpbGUiXSA9IERhdGFDb25uZWN0aW9uKCJEZWNvbXBpbGUiLCAiU291cmNlU2NyaXB0IiksCgkJCVsiRGVjb21waWxlIENhbGxpbmciXSA9IERhdGFDb25uZWN0aW9uKCJEZWNvbXBpbGUiLCAiQ2FsbGluZ1NjcmlwdCIpLAoJCQlbIlJlcGVhdCBDYWxsIl0gPSBEYXRhQ29ubmVjdGlvbigiUmVwZWF0Q2FsbCIpLAoJCQlbIlNhdmUgQnl0ZWNvZGUiXSA9IERhdGFDb25uZWN0aW9uKCJTYXZlQnl0ZWNvZGUiKSwKCQl9KQoJZW5kCglmdW5jdGlvbiBEYXRhOkJ1aWxkU2NyaXB0KEJ1dHRvbjogR3VpQnV0dG9uKQoJCVVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbiwge3NlbGZ9LCB7CgkJCVsiQ2FsbCBSZW1vdGUiXSA9IERhdGFDb25uZWN0aW9uKCJNYWtlU2NyaXB0IiwgIlJlbW90ZSIpLAoJCQlbIkJsb2NrIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiQmxvY2siKSwKCQkJWyJSZXBlYXQgRm9yIl0gPSBEYXRhQ29ubmVjdGlvbigiTWFrZVNjcmlwdCIsICJSZXBlYXQiKSwKCQkJWyJTcGFtIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiU3BhbSIpCgkJfSkKCWVuZAoJZnVuY3Rpb24gRGF0YTpTYXZlQnl0ZWNvZGUoKQoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhTY3JpcHQsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQktLS8vIGdldHNjcmlwdGJ5dGVjb2RlCiAgICAJbG9jYWwgU3VjY2VzcywgQnl0ZWNvZGUgPSBwY2FsbChnZXRzY3JpcHRieXRlY29kZSwgU2NyaXB0KQoJCWlmIG5vdCBTdWNjZXNzIHRoZW4KCQkJVWk6U2hvd01vZGFsKHsiRmFpbGVkIHRvIGdldCBTY3JpcHRlIGJ5dGVjb2RlICgtOTk5OTk5OSBBVVJBKSJ9KQoJCQlyZXR1cm4KCQllbmQKCgkJLS0vLyBTYXZlIGZpbGUKCQlsb2NhbCBQYXRoQmFzZSA9IGB7U2NyaXB0fSAlcy50eHRgCgkJbG9jYWwgRmlsZVBhdGggPSBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoUGF0aEJhc2UpCgkJd3JpdGVmaWxlKEZpbGVQYXRoLCBCeXRlY29kZSkKCgkJVWk6U2hvd01vZGFsKHsiU2F2ZWQgYnl0ZWNvZGUgdG8iLCBGaWxlUGF0aH0pCgllbmQKCWZ1bmN0aW9uIERhdGE6TWFrZVNjcmlwdChTY3JpcHRUeXBlOiBzdHJpbmcpCgkJbG9jYWwgU2NyaXB0ID0gR2VuZXJhdGlvbjpSZW1vdGVTY3JpcHQoTW9kdWxlLCBzZWxmLCBTY3JpcHRUeXBlKQoJCVNldElERVRleHQoU2NyaXB0LCBgRWRpdGluZzoge1JlbW90ZU5hbWV9Lmx1YWApCgllbmQKCWZ1bmN0aW9uIERhdGE6UmVwZWF0Q2FsbCgpCgkJbG9jYWwgU2lnbmFsID0gSG9vazpJbmRleChSZW1vdGUsIE1ldGhvZCkKCgkJaWYgSXNSZWNlaXZlIHRoZW4KCQkJZmlyZXNpZ25hbChTaWduYWwsIFByb2Nlc3M6VW5wYWNrKEFyZ3MpKQoJCWVsc2UKCQkJU2lnbmFsKFJlbW90ZSwgUHJvY2VzczpVbnBhY2soQXJncykpCgkJZW5kCgllbmQKCWZ1bmN0aW9uIERhdGE6R2V0UmV0dXJuKCkKCQlsb2NhbCBSZXR1cm5WYWx1ZXMgPSBzZWxmLlJldHVyblZhbHVlcwoKCQktLS8vIEVycm9yIG1lc3NhZ2VzCgkJaWYgbm90IElzUmVtb3RlRnVuY3Rpb24gdGhlbgoJCQlVaTpTaG93TW9kYWwoeyJUaGUgUmVtb3RlIGlzIG5vdCBhIFJlbW90ZSBGdW5jdGlvbiAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgkJaWYgbm90IFJldHVyblZhbHVlcyB0aGVuCgkJCVVpOlNob3dNb2RhbCh7Ik5vIHJldHVybiB2YWx1ZXMgKC05OTk5OTk5IEFVUkEpIn0pCgkJCXJldHVybgoJCWVuZAoKCQktLS8vIEdlbmVyYXRlIHNjcmlwdAoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBSZXR1cm5WYWx1ZXMpCgkJU2V0SURFVGV4dChTY3JpcHQsIGBSZXR1cm4gVmFsdWVzIGZvcjoge1JlbW90ZU5hbWV9YCkKCWVuZAoJZnVuY3Rpb24gRGF0YTpHZW5lcmF0ZUluZm8oKQoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhuaWwsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQktLS8vIEdlbmVyYXRlIHNjcmlwdAoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246QWR2YW5jZWRJbmZvKE1vZHVsZSwgc2VsZikKCQlTZXRJREVUZXh0KFNjcmlwdCwgYEFkdmFuY2VkIEluZm8gZm9yOiB7UmVtb3RlTmFtZX1gKQoJZW5kCglmdW5jdGlvbiBEYXRhOkRlY29tcGlsZShXaGljaFNjcmlwdDogc3RyaW5nKQoJCWxvY2FsIERlY29tcGlsZVBvcG91dCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiRGVjb21waWxlUG9wb3V0IikKCQlsb2NhbCBUb0RlY29tcGlsZSA9IERhdGFbV2hpY2hTY3JpcHRdCgkJbG9jYWwgRWRpdG9yID0gQ29kZUVkaXRvcgoKCQktLS8vIFByb2JsZW0gY2hlY2sKCQlpZiBub3QgU2NyaXB0Q2hlY2soVG9EZWNvbXBpbGUsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCBUYXNrID0gVWk6RmlsdGVyTmFtZShgVmlld2luZzoge1RvRGVjb21waWxlfS5sdWFgLCAyMDApCgkJCgkJLS0vLyBBdXRvbWF0aWNhbGx5IFBvcC1vdXQgdGhlIGVkaXRvciBmb3IgZGVjb21waWxpbmcgaWYgZW5hYmxlZAoJCWlmIERlY29tcGlsZVBvcG91dCB0aGVuCgkJCUVkaXRvciA9IFVpOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coRGVjb21waWxlZCwgewoJCQkJVGl0bGUgPSBUYXNrCgkJCX0pCgkJZW5kCgoJCVVpOkRlY29tcGlsZShFZGl0b3IsIFRvRGVjb21waWxlKQoJZW5kCgkKCS0tLy8gUmVtb3RlT3B0aW9ucwoJc2VsZjpDcmVhdGVPcHRpb25zRm9yRGljdChUYWIsIFJlbW90ZURhdGEsIGZ1bmN0aW9uKCkKCQlQcm9jZXNzOlVwZGF0ZVJlbW90ZURhdGEoSWQsIFJlbW90ZURhdGEpCgllbmQpCgoJLS0vLyBJbnN0YW5jZSBvcHRpb25zCglzZWxmOkNyZWF0ZUJ1dHRvbnMoVGFiLCB7CgkJQmFzZSA9IHsKCQkJU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyMCksCgkJCUF1dG9tYXRpY1NpemUgPSBFbnVtLkF1dG9tYXRpY1NpemUuWSwKCQl9LAoJCUJ1dHRvbnMgPSB7CgkJCXsKCQkJCVRleHQgPSAiQ29weSBzY3JpcHQgcGF0aCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlTZXRDbGlwYm9hcmQoUGFyc2VyOk1ha2VQYXRoU3RyaW5nKHsKCQkJCQkJT2JqZWN0ID0gU2NyaXB0LAoJCQkJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQkJCQl9KSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJDb3B5IHJlbW90ZSBwYXRoIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVNldENsaXBib2FyZChQYXJzZXI6TWFrZVBhdGhTdHJpbmcoewoJCQkJCQlPYmplY3QgPSBSZW1vdGUsCgkJCQkJCU5vVmFyaWFibGVzID0gdHJ1ZQoJCQkJCX0pKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlJlbW92ZSBsb2ciLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJSW5mb1NlbGVjdG9yOlJlbW92ZVRhYihUYWIpCgkJCQkJRGF0YS5TZWxlY3RhYmxlOlJlbW92ZSgpCgkJCQkJSGVhZGVyRGF0YTpSZW1vdmUoKQoJCQkJCUFjdGl2ZURhdGEgPSBuaWwKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJEdW1wIGxvZ3MiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgTG9ncyA9IEhlYWRlckRhdGEuRW50cmllcwoJCQkJCWxvY2FsIEZpbGVQYXRoID0gR2VuZXJhdGlvbjpEdW1wTG9ncyhMb2dzKQoJCQkJCXNlbGY6U2hvd01vZGFsKHsiU2F2ZWQgZHVtcCB0byIsIEZpbGVQYXRofSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJWaWV3IENvbm5lY3Rpb25zIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIE1ldGhvZCA9IENsYXNzRGF0YS5SZWNlaXZlWzFdCgkJCQkJbG9jYWwgU2lnbmFsID0gUmVtb3RlW01ldGhvZF0KCQkJCQlzZWxmOlZpZXdDb25uZWN0aW9ucyhSZW1vdGVOYW1lLCBTaWduYWwpCgkJCQllbmQsCgkJCX0KCQl9Cgl9KQoKCS0tLy8gUmVtb3RlIGluZm9ybWF0aW9uIHRhYmxlCglzZWxmOkRpc3BsYXlUYWJsZShUYWIsIHsKCQlSb3dzID0geyJOYW1lIiwgIlZhbHVlIn0sCgkJVGFibGUgPSBEYXRhLAoJCVRvRGlzcGxheSA9IFRvRGlzcGxheSwKCQlGbGFncyA9IHsKCQkJQm9yZGVyID0gdHJ1ZSwKCQkJUm93QmFja2dyb3VuZCA9IHRydWUsCgkJCU1heENvbHVtbnMgPSAyCgkJfQoJfSkKCQoJLS0vLyBBcmd1bWVudHMgdGFibGUgc2NyaXB0CglpZiBUYWJsZUFyZ3MgdGhlbgoJCWxvY2FsIFBhcnNlZCA9IEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBBcmdzKQoJCVNldElERVRleHQoUGFyc2VkKQoJCXJldHVybgoJZW5kCgoJLS0vLyBSZW1vdGUgY2FsbCBzY3JpcHQKCURhdGE6TWFrZVNjcmlwdCgiUmVtb3RlIikKZW5kCgpmdW5jdGlvbiBVaTpWaWV3Q29ubmVjdGlvbnMoUmVtb3RlTmFtZTogc3RyaW5nLCBTaWduYWw6IFJCWFNjcmlwdENvbm5lY3Rpb24pCglsb2NhbCBXaW5kb3cgPSBzZWxmOkNyZWF0ZVdpbmRvdyh7CgkJVGl0bGUgPSBgQ29ubmVjdGlvbnMgZm9yOiB7UmVtb3RlTmFtZX1gLAoJCVNpemUgPSBVRGltMi5mcm9tT2Zmc2V0KDQ1MCwgMjUwKQoJfSkKCglsb2NhbCBUb0Rpc3BsYXkgPSB7CgkJIkVuYWJsZWQiLAoJCSJMdWFDb25uZWN0aW9uIiwKCQkiU2NyaXB0IgoJfQoKCS0tLy8gR2V0IEZpbHRlcmVkIGNvbm5lY3Rpb25zCglsb2NhbCBDb25uZWN0aW9ucyA9IFByb2Nlc3M6RmlsdGVyQ29ubmVjdGlvbnMoU2lnbmFsLCBUb0Rpc3BsYXkpCgoJLS0vLyBUYWJsZQoJbG9jYWwgVGFibGUgPSBXaW5kb3c6VGFibGUoewoJCUJvcmRlciA9IHRydWUsCgkJUm93QmFja2dyb3VuZCA9IHRydWUsCgkJTWF4Q29sdW1ucyA9IDMKCX0pCgoJbG9jYWwgQnV0dG9uc0ZvclZhbHVlcyA9IHsKCQlbIlNjcmlwdCJdID0gZnVuY3Rpb24oUm93LCBWYWx1ZSkKCQkJUm93OkJ1dHRvbih7CgkJCQlUZXh0ID0gIkRlY29tcGlsZSIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBUYXNrID0gc2VsZjpGaWx0ZXJOYW1lKGBWaWV3aW5nOiB7VmFsdWV9Lmx1YWAsIDIwMCkKCQkJCQlsb2NhbCBFZGl0b3IgPSBzZWxmOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3cobmlsLCB7CgkJCQkJCVRpdGxlID0gVGFzawoJCQkJCX0pCgkJCQkJc2VsZjpEZWNvbXBpbGUoRWRpdG9yLCBWYWx1ZSkKCQkJCWVuZAoJCQl9KQoJCWVuZCwKCQlbIkVuYWJsZWQiXSA9IGZ1bmN0aW9uKFJvdywgRW5hYmxlZCwgQ29ubmVjdGlvbikKCQkJUm93OkJ1dHRvbih7CgkJCQlUZXh0ID0gRW5hYmxlZCBhbmQgIkRpc2FibGUiIG9yICJFbmFibGUiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxmKQoJCQkJCUVuYWJsZWQgPSBub3QgRW5hYmxlZAoJCQkJCXNlbGYuVGV4dCA9IEVuYWJsZWQgYW5kICJEaXNhYmxlIiBvciAiRW5hYmxlIgoKCQkJCQktLS8vIEVuYWJsZSBvciBkaXNhYmxlIHRoZSBjb25uZWN0aW9uCgkJCQkJaWYgRW5hYmxlZCB0aGVuCgkJCQkJCUNvbm5lY3Rpb246RW5hYmxlKCkKCQkJCQllbHNlCgkJCQkJCUNvbm5lY3Rpb246RGlzYWJsZSgpCgkJCQkJZW5kCgkJCQllbmQKCQkJfSkKCQllbmQKCX0KCgktLS8vIE1ha2UgaGVhZGVycyBvbiB0aGUgdGFibGUKCXNlbGY6TWFrZVRhYmxlSGVhZGVycyhUYWJsZSwgVG9EaXNwbGF5KQoKCWZvciBfLCBDb25uZWN0aW9uIGluIENvbm5lY3Rpb25zIGRvCgkJbG9jYWwgUm93ID0gVGFibGU6Um93KCkKCgkJZm9yIF8sIFByb3BlcnR5IGluIFRvRGlzcGxheSBkbwoJCQlsb2NhbCBDb2x1bW4gPSBSb3c6TmV4dENvbHVtbigpCgkJCWxvY2FsIENvbHVtblJvdyA9IENvbHVtbjpSb3coKQoKCQkJbG9jYWwgVmFsdWUgPSBDb25uZWN0aW9uW1Byb3BlcnR5XQoJCQlsb2NhbCBDYWxsYmFjayA9IEJ1dHRvbnNGb3JWYWx1ZXNbUHJvcGVydHldCgoJCQktLS8vIFZhbHVlIGxhYmVsCgkJCUNvbHVtblJvdzpMYWJlbCh7VGV4dD1ge1ZhbHVlfWB9KQoKCQkJLS0vLyBBZGQgYnV0dG9ucwoJCQlpZiBDYWxsYmFjayB0aGVuCgkJCQlDYWxsYmFjayhDb2x1bW5Sb3csIFZhbHVlLCBDb25uZWN0aW9uKQoJCQllbmQKCQllbmQKCWVuZAoKCS0tLy8gQ2VudGVyIFdpbmRvdwoJV2luZG93OkNlbnRlcigpCmVuZAoKZnVuY3Rpb24gVWk6R2V0UmVtb3RlSGVhZGVyKERhdGE6IExvZykKCWxvY2FsIExvZ0xpbWl0ID0gc2VsZi5Mb2dMaW1pdAoJbG9jYWwgTG9ncyA9IHNlbGYuTG9ncwoJbG9jYWwgUmVtb3Rlc0xpc3QgPSBzZWxmLlJlbW90ZXNMaXN0CgoJLS0vLyBSZW1vdGUgaW5mbwoJbG9jYWwgSWQgPSBEYXRhLklkCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgUmVtb3RlTmFtZSA9IHNlbGY6RmlsdGVyTmFtZShge1JlbW90ZX1gLCAzMCkKCgktLS8vIE5vVHJlZU5vZGVzCglsb2NhbCBOb1RyZWVOb2RlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTm9UcmVlTm9kZXMiKQoKCS0tLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIFRyZWVOb2RlCglsb2NhbCBFeGlzdGluZyA9IExvZ3NbSWRdCglpZiBFeGlzdGluZyB0aGVuIHJldHVybiBFeGlzdGluZyBlbmQKCgktLS8vIEhlYWRlciBkYXRhCglsb2NhbCBIZWFkZXJEYXRhID0gewkKCQlMb2dDb3VudCA9IDAsCgkJRGF0YSA9IERhdGEsCgkJRW50cmllcyA9IHt9Cgl9CgoJLS0vLyBJbmNyZW1lbnQgdHJlZW5vZGUgY291bnQKCVJlbW90ZXNDb3VudCArPSAxCgoJLS0vLyBDcmVhdGUgbmV3IHRyZWVub2RlIGVsZW1lbnQKCWlmIG5vdCBOb1RyZWVOb2RlcyB0aGVuCgkJSGVhZGVyRGF0YS5UcmVlTm9kZSA9IFJlbW90ZXNMaXN0OlRyZWVOb2RlKHsKCQkJTGF5b3V0T3JkZXIgPSAtMSAqIFJlbW90ZXNDb3VudCwKCQkJVGl0bGUgPSBSZW1vdGVOYW1lCgkJfSkKCWVuZAoKCWZ1bmN0aW9uIEhlYWRlckRhdGE6Q2hlY2tMaW1pdCgpCgkJbG9jYWwgRW50cmllcyA9IHNlbGYuRW50cmllcwoJCWlmICNFbnRyaWVzIDwgTG9nTGltaXQgdGhlbiByZXR1cm4gZW5kCgkJCQoJCS0tLy8gR2V0IGFuZCByZW1vdmUgbGFzdCBlbGVtZW50CgkJbG9jYWwgTG9nID0gdGFibGUucmVtb3ZlKEVudHJpZXMsIDEpCgkJTG9nLlNlbGVjdGFibGU6UmVtb3ZlKCkKCWVuZAoKCWZ1bmN0aW9uIEhlYWRlckRhdGE6TG9nQWRkZWQoRGF0YSkKCQktLS8vIEluY3JlbWVudCBsb2cgY291bnQKCQlzZWxmLkxvZ0NvdW50ICs9IDEKCQlzZWxmOkNoZWNrTGltaXQoKQoKCQktLS8vIEFkZCBlbnRyeQoJCWxvY2FsIEVudHJpZXMgPSBzZWxmLkVudHJpZXMKCQl0YWJsZS5pbnNlcnQoRW50cmllcywgRGF0YSkKCQkKCQlyZXR1cm4gc2VsZgoJZW5kCgoJZnVuY3Rpb24gSGVhZGVyRGF0YTpSZW1vdmUoKQoJCS0tLy8gUmVtb3ZlIFRyZWVOb2RlCgkJbG9jYWwgVHJlZU5vZGUgPSBzZWxmLlRyZWVOb2RlCgkJaWYgVHJlZU5vZGUgdGhlbgoJCQlUcmVlTm9kZTpSZW1vdmUoKQoJCWVuZAoKCQktLS8vIENsZWFyIHRhYmxlcyBmcm9tIG1lbW9yeQoJCUxvZ3NbSWRdID0gbmlsCgkJdGFibGUuY2xlYXIoSGVhZGVyRGF0YSkKCWVuZAoKCUxvZ3NbSWRdID0gSGVhZGVyRGF0YQoJcmV0dXJuIEhlYWRlckRhdGEKZW5kCgpmdW5jdGlvbiBVaTpDbGVhckxvZ3MoKQoJbG9jYWwgTG9ncyA9IHNlbGYuTG9ncwoJbG9jYWwgUmVtb3Rlc0xpc3QgPSBzZWxmLlJlbW90ZXNMaXN0CgoJLS0vLyBDbGVhciBhbGwgZWxlbWVudHMKCVJlbW90ZXNDb3VudCA9IDAKCVJlbW90ZXNMaXN0OkNsZWFyQ2hpbGRFbGVtZW50cygpCgoJLS0vLyBDbGVhciBsb2dzIGZyb20gbWVtb3J5Cgl0YWJsZS5jbGVhcihMb2dzKQplbmQKCmZ1bmN0aW9uIFVpOlF1ZXVlTG9nKERhdGEpCglsb2NhbCBMb2dRdWV1ZSA9IHNlbGYuTG9nUXVldWUKICAgIHRhYmxlLmluc2VydChMb2dRdWV1ZSwgRGF0YSkKZW5kCgpmdW5jdGlvbiBVaTpQcm9jZXNzTG9nUXVldWUoKQoJbG9jYWwgUXVldWUgPSBzZWxmLkxvZ1F1ZXVlCiAgICBpZiAjUXVldWUgPD0gMCB0aGVuIHJldHVybiBlbmQKCgktLS8vIENyZWF0ZSBhIGxvZyBlbGVtZW50IGZvciBlYWNoIGluIHRoZSBRdWV1ZQogICAgZm9yIEluZGV4LCBEYXRhIGluIG5leHQsIFF1ZXVlIGRvCiAgICAgICAgc2VsZjpDcmVhdGVMb2coRGF0YSkKICAgICAgICB0YWJsZS5yZW1vdmUoUXVldWUsIEluZGV4KQogICAgZW5kCmVuZAoKZnVuY3Rpb24gVWk6QmVnaW5Mb2dTZXJ2aWNlKCkKCWNvcm91dGluZS53cmFwKGZ1bmN0aW9uKCkKCQl3aGlsZSB0cnVlIGRvCgkJCXNlbGY6UHJvY2Vzc0xvZ1F1ZXVlKCkKCQkJdGFzay53YWl0KCkKCQllbmQKCWVuZCkoKQplbmQKCmZ1bmN0aW9uIFVpOkZpbHRlck5hbWUoTmFtZTogc3RyaW5nLCBDaGFyYWN0ZXJMaW1pdDogbnVtYmVyPyk6IHN0cmluZwoJbG9jYWwgVHJpbW1lZCA9IE5hbWU6c3ViKDEsIENoYXJhY3RlckxpbWl0IG9yIDIwKQoJbG9jYWwgRmlsdHJlZCA9IFRyaW1tZWQ6Z3N1YigiW1xuXHJdIiwgIiIpCglGaWx0cmVkID0gR2VuZXJhdGlvbjpNYWtlUHJpbnRhYmxlKEZpbHRyZWQpCgoJcmV0dXJuIEZpbHRyZWQKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVMb2coRGF0YTogTG9nKQoJLS0vLyBVbnBhY2sgbG9nIGRhdGEKICAgIGxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAogICAgbG9jYWwgQXJncyA9IERhdGEuQXJncwogICAgbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCWxvY2FsIElkID0gRGF0YS5JZAoJbG9jYWwgVGltZXN0YW1wID0gRGF0YS5UaW1lc3RhbXAKCWxvY2FsIElzRXhwbG9pdCA9IERhdGEuSXNFeHBsb2l0CgkKCWxvY2FsIElzTmlsUGFyZW50ID0gSG9vazpJbmRleChSZW1vdGUsICJQYXJlbnQiKSA9PSBuaWwKCWxvY2FsIFJlbW90ZURhdGEgPSBQcm9jZXNzOkdldFJlbW90ZURhdGEoSWQpCgoJLS0vLyBQYXVzZWQKCWxvY2FsIFBhdXNlZCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiUGF1c2VkIikKCWlmIFBhdXNlZCB0aGVuIHJldHVybiBlbmQKCgktLS8vIENoZWNrIGNhbGxlciAoSWdub3JlIGV4cGxvaXQgY2FsbHMpCglsb2NhbCBMb2dFeHBsb2l0ID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJMb2dFeHBsb2l0IikKCWlmIG5vdCBMb2dFeHBsb2l0IGFuZCBJc0V4cGxvaXQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBJZ25vcmVOaWwKCWxvY2FsIElnbm9yZU5pbCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiSWdub3JlTmlsIikKCWlmIElnbm9yZU5pbCBhbmQgSXNOaWxQYXJlbnQgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBMb2dSZWNpdmVzIGNoZWNrCglsb2NhbCBMb2dSZWNpdmVzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJMb2dSZWNpdmVzIikKCWlmIG5vdCBMb2dSZWNpdmVzIGFuZCBJc1JlY2VpdmUgdGhlbiByZXR1cm4gZW5kCgoJbG9jYWwgU2VsZWN0TmV3ZXN0ID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJTZWxlY3ROZXdlc3QiKQoJbG9jYWwgTm9UcmVlTm9kZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIk5vVHJlZU5vZGVzIikKCiAgICAtLS8vIEV4Y2x1ZGVkIGNoZWNrCiAgICBpZiBSZW1vdGVEYXRhLkV4Y2x1ZGVkIHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gRGVzZXJpYWxpemUgYXJndW1lbnRzCglBcmdzID0gQ29tbXVuaWNhdGlvbjpEZXNlcmlhbGl6ZVRhYmxlKEFyZ3MpCgoJLS0vLyBEZWVwIGNsb25lIGRhdGEKCWxvY2FsIENsb25lZEFyZ3MgPSBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKEFyZ3MpCglEYXRhLkFyZ3MgPSBDbG9uZWRBcmdzCglEYXRhLlZhbHVlU3dhcHMgPSBHZW5lcmF0aW9uOk1ha2VWYWx1ZVN3YXBzVGFibGUoVGltZXN0YW1wKQoKCS0tLy8gR2VuZXJhdGUgbG9nIHRpdGxlCglsb2NhbCBDb2xvciA9IENvbmZpZy5NZXRob2RDb2xvcnNbTWV0aG9kOmxvd2VyKCldCglsb2NhbCBUZXh0ID0gTm9UcmVlTm9kZXMgYW5kIGB7UmVtb3RlfSB8IHtNZXRob2R9YCBvciBNZXRob2QKCgktLS8vIEZpbmRTdHJpbmdGb3JOYW1lIGNoZWNrCglsb2NhbCBGaW5kU3RyaW5nID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJGaW5kU3RyaW5nRm9yTmFtZSIpCglpZiBGaW5kU3RyaW5nIHRoZW4KCQlmb3IgXywgQXJnIGluIG5leHQsIENsb25lZEFyZ3MgZG8KCQkJaWYgdHlwZW9mKEFyZykgPT0gInN0cmluZyIgdGhlbgoJCQkJbG9jYWwgRmlsdHJlZCA9IHNlbGY6RmlsdGVyTmFtZShBcmcpCgkJCQlUZXh0ID0gYHtGaWx0cmVkfSB8IHtUZXh0fWAKCQkJCWJyZWFrCgkJCWVuZAoJCWVuZAoJZW5kCgoJLS0vLyBGZXRjaCBIZWFkZXJEYXRhIGJ5IHRoZSBSZW1vdGVJRCB1c2VkIGZvciBzdGFja2luZwoJbG9jYWwgSGVhZGVyID0gc2VsZjpHZXRSZW1vdGVIZWFkZXIoRGF0YSkKCWxvY2FsIFJlbW90ZXNMaXN0ID0gc2VsZi5SZW1vdGVzTGlzdAoKCWxvY2FsIExvZ0NvdW50ID0gSGVhZGVyLkxvZ0NvdW50Cglsb2NhbCBUcmVlTm9kZSA9IEhlYWRlci5UcmVlTm9kZSAKCWxvY2FsIFBhcmVudCA9IFRyZWVOb2RlIG9yIFJlbW90ZXNMaXN0CgoJLS0vLyBJbmNyZWFzZSBsb2cgY291bnQgLSBUcmVlTm9kZXMgYXJlIGluIEdldFJlbW90ZUhlYWRlciBmdW5jdGlvbgoJaWYgTm9UcmVlTm9kZXMgdGhlbgoJCVJlbW90ZXNDb3VudCArPSAxCgkJTG9nQ291bnQgPSBSZW1vdGVzQ291bnQKCWVuZAoKICAgIC0tLy8gQ3JlYXRlIGZvY3VzIGJ1dHRvbgoJRGF0YS5IZWFkZXJEYXRhID0gSGVhZGVyCglEYXRhLlNlbGVjdGFibGUgPSBQYXJlbnQ6U2VsZWN0YWJsZSh7CgkJVGV4dCA9IFRleHQsCiAgICAgICAgTGF5b3V0T3JkZXIgPSAtMSAqIExvZ0NvdW50LAoJCVRleHRDb2xvcjMgPSBDb2xvciwKCQlUZXh0WEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuTGVmdCwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJc2VsZjpTZXRGb2N1c2VkUmVtb3RlKERhdGEpCgkJZW5kLAogICAgfSkKCglIZWFkZXI6TG9nQWRkZWQoRGF0YSkKCgktLS8vIEF1dG8gc2VsZWN0IGNoZWNrCglsb2NhbCBHcm91cFNlbGVjdGVkID0gQWN0aXZlRGF0YSBhbmQgQWN0aXZlRGF0YS5IZWFkZXJEYXRhID09IEhlYWRlcgoJaWYgU2VsZWN0TmV3ZXN0IGFuZCBHcm91cFNlbGVjdGVkIHRoZW4KCQlzZWxmOlNldEZvY3VzZWRSZW1vdGUoRGF0YSkKCWVuZAplbmQKCnJldHVybiBVaQ=="},
	Generation = {"base64", "dHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglBcmdzOiB0YWJsZSwKCU1ldGhvZDogc3RyaW5nLAogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsCglWYWx1ZVJlcGxhY2VtZW50czogdGFibGUsCglOb1ZhcmlhYmxlczogYm9vbGVhbj8KfQoKLS0vLyBNb2R1bGUKbG9jYWwgR2VuZXJhdGlvbiA9IHsKCUR1bXBCYXNlTmFtZSA9ICJTaWdtYVNweS1EdW1wICVzLmx1YSIsCglTY3JpcHRUZW1wbGF0ZXMgPSB7CgkJWyJSZW1vdGUiXSA9IHsKCQkJeyIlUmVtb3RlQ2FsbCUifQoJCX0sCgkJWyJTcGFtIl0gPSB7CgkJCXsid2hpbGUgd2FpdCgpIGRvIn0sCgkJCXsiJVJlbW90ZUNhbGwlIiwgMn0sCgkJCXsiZW5kIn0KCQl9LAoJCVsiUmVwZWF0Il0gPSB7CgkJCXsiZm9yIEluZGV4ID0gMSwgMTAgZG8ifSwKCQkJeyIlUmVtb3RlQ2FsbCUiLCAyfSwKCQkJeyJlbmQifQoJCX0sCgkJWyJCbG9jayJdID0gewoJCQlbIl9faW5kZXgiXSA9IHsKCQkJCXsibG9jYWwgT2xkOyBPbGQgPSBob29rZnVuY3Rpb24oJVNpZ25hbCUsIGZ1bmN0aW9uKHNlbGYsIC4uLikifSwKCQkJCXsiaWYgc2VsZiA9PSAlUmVtb3RlJSB0aGVuIiwgMn0sCgkJCQl7InJldHVybiIsIDN9LAoJCQkJeyJlbmQiLCAyfSwKCQkJCXsicmV0dXJuIE9sZChzZWxmLCAuLi4pIiwgMn0sCgkJCQl7ImVuZCkifQoJCQl9LAoJCQlbIl9fbmFtZWNhbGwiXSA9IHsKCQkJCXsibG9jYWwgT2xkOyBPbGQgPSBob29rbWV0YW1ldGhvZChnYW1lLCBcIl9fbmFtZWNhbGxcIiwgZnVuY3Rpb24oc2VsZiwgLi4uKSJ9LAoJCQkJeyJsb2NhbCBNZXRob2QgPSBnZXRuYW1lY2FsbG1ldGhvZCgpIiwgMn0sCgkJCQl7ImlmIHNlbGYgPT0gJVJlbW90ZSUgYW5kIE1ldGhvZCA9PSBcIiVNZXRob2QlXCIgdGhlbiIsIDJ9LAoJCQkJeyJyZXR1cm4iLCAzfSwKCQkJCXsiZW5kIiwgMn0sCgkJCQl7InJldHVybiBPbGQoc2VsZiwgLi4uKSIsIDJ9LAoJCQkJeyJlbmQpIn0KCQkJfSwKCQkJWyJDb25uZWN0Il0gPSB7CgkJCQl7ImZvciBfLCBDb25uZWN0aW9uIGluIGdldGNvbm5lY3Rpb25zKCVTaWduYWwlKSBkbyJ9LAoJCQkJeyJDb25uZWN0aW9uOkRpc2FibGUoKSIsIDJ9LAoJCQkJeyJlbmQifQoJCQl9CgkJfQoJfQp9CgotLS8vIE1vZHVsZXMKbG9jYWwgQ29uZmlnCmxvY2FsIEhvb2sKbG9jYWwgUGFyc2VyTW9kdWxlCmxvY2FsIFRoaXNTY3JpcHQgPSBzY3JpcHQKCmxvY2FsIGZ1bmN0aW9uIE1lcmdlKEJhc2U6IHRhYmxlLCBOZXc6IHRhYmxlKQoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvCgkJQmFzZVtLZXldID0gVmFsdWUKCWVuZAplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246SW5pdChEYXRhOiB0YWJsZSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCWxvY2FsIENvbmZpZ3VyYXRpb24gPSBNb2R1bGVzLkNvbmZpZ3VyYXRpb24KCgktLS8vIE1vZHVsZXMKCUNvbmZpZyA9IE1vZHVsZXMuQ29uZmlnCglIb29rID0gTW9kdWxlcy5Ib29rCgkKCS0tLy8gSW1wb3J0IHBhcnNlcgoJbG9jYWwgUGFyc2VyVXJsID0gQ29uZmlndXJhdGlvbi5QYXJzZXJVcmwKCXNlbGY6TG9hZFBhcnNlcihQYXJzZXJVcmwpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlUHJpbnRhYmxlKFN0cmluZzogc3RyaW5nKTogc3RyaW5nCglsb2NhbCBGb3JtYXR0ZXIgPSBQYXJzZXJNb2R1bGUuTW9kdWxlcy5Gb3JtYXR0ZXIKCXJldHVybiBGb3JtYXR0ZXI6TWFrZVByaW50YWJsZShTdHJpbmcpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpUaW1lU3RhbXBGaWxlKEZpbGVQYXRoOiBzdHJpbmcpOiBzdHJpbmcKCWxvY2FsIFRpbWVTdGFtcCA9IG9zLmRhdGUoIiVZLSVtLSVkXyVILSVNLSVTIikKCWxvY2FsIEZvcm1hdHRlZCA9IEZpbGVQYXRoOmZvcm1hdChUaW1lU3RhbXApCglyZXR1cm4gRm9ybWF0dGVkCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpXcml0ZUR1bXAoQ29udGVudDogc3RyaW5nKTogc3RyaW5nCglsb2NhbCBEdW1wQmFzZU5hbWUgPSBzZWxmLkR1bXBCYXNlTmFtZQoJbG9jYWwgRmlsZVBhdGggPSBzZWxmOlRpbWVTdGFtcEZpbGUoRHVtcEJhc2VOYW1lKQoKCS0tLy8gV3JpdGUgdG8gZmlsZQoJd3JpdGVmaWxlKEZpbGVQYXRoLCBDb250ZW50KQoKCXJldHVybiBGaWxlUGF0aAplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246TG9hZFBhcnNlcihJbXBvcnRVcmw6IHN0cmluZykKCWxvY2FsIE1haW5QYXRoID0gYHtJbXBvcnRVcmx9L21haW4ubHVhYAoJbG9jYWwgTWFpbkNvbnRlbnQgPSBnYW1lOkh0dHBHZXQoTWFpblBhdGgpCglQYXJzZXJNb2R1bGUgPSBsb2Fkc3RyaW5nKE1haW5Db250ZW50LCAiUGFyc2VyIikoKQoJCgktLS8vIENvbmZpZ3VyZSBQYXJzZXIgaW1wb3J0cyB0byB1c2UgZ2FtZTpIdHRwR2V0CglmdW5jdGlvbiBQYXJzZXJNb2R1bGU6SW1wb3J0KE5hbWU6IHN0cmluZykKCQlsb2NhbCBVcmwgPSBge0ltcG9ydFVybH0ve05hbWV9Lmx1YWAKCQlsb2NhbCBDb250ZW50ID0gZ2FtZTpIdHRwR2V0KFVybCkKCQlsb2NhbCBDbG9zdXJlID0gbG9hZHN0cmluZyhDb250ZW50LCBOYW1lKQoJCXJldHVybiBDbG9zdXJlKCkKCWVuZAoKCS0tLy8gTG9hZCBwYXJzZXIgbW9kdWxlCglQYXJzZXJNb2R1bGU6TG9hZCgpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlVmFsdWVTd2Fwc1RhYmxlKCk6IHRhYmxlCglsb2NhbCBGb3JtYXR0ZXIgPSBQYXJzZXJNb2R1bGUuTW9kdWxlcy5Gb3JtYXR0ZXIKCXJldHVybiBGb3JtYXR0ZXI6TWFrZVJlcGxhY2VtZW50cygpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpTZXRTd2Fwc0NhbGxiYWNrKENhbGxiYWNrOiAoSW50ZXJmYWNlOiB0YWJsZSkgLT4gKCkpCglzZWxmLlN3YXBzQ2FsbGJhY2sgPSBDYWxsYmFjawplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246R2V0QmFzZShNb2R1bGUpOiAoc3RyaW5nLCBib29sZWFuKQoJLS1sb2NhbCBDb2RlID0gIi0tIEdlbmVyYXRlZCB3aXRoIHNpZ21hIHNweSBCT0lJSUlJSUlJSSAoKzk5OTk5OTkgQVVSQSlcbiIKCWxvY2FsIENvZGUgPSAiLS0gR2VuZXJhdGVkIHdpdGggU2lnbWEgU3B5IEdpdGh1YjogaHR0cHM6Ly9naXRodWIuY29tL2RlcHRoc28vU2lnbWEtU3B5XG4iCgoJLS0vLyBHZW5lcmF0ZSB2YXJpYWJsZXMgY29kZQoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlBhcnNlcjpNYWtlVmFyaWFibGVDb2RlKHsKCQkiU2VydmljZXMiLCAiUmVtb3RlIiwgIlZhcmlhYmxlcyIKCX0pCgoJbG9jYWwgTm9WYXJpYWJsZXMgPSBWYXJpYWJsZXMgPT0gIiIKCUNvZGUgLi49IFZhcmlhYmxlcwoKCXJldHVybiBDb2RlLCBOb1ZhcmlhYmxlcwplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246R2V0U3dhcHMoKQoJbG9jYWwgRnVuYyA9IHNlbGYuU3dhcHNDYWxsYmFjawoJbG9jYWwgU3dhcHMgPSB7fQoKCWxvY2FsIEludGVyZmFjZSA9IHt9CglmdW5jdGlvbiBJbnRlcmZhY2U6QWRkU3dhcChPYmplY3Q6IEluc3RhbmNlLCBEYXRhOiB0YWJsZSkKCQlpZiBub3QgT2JqZWN0IHRoZW4gcmV0dXJuIGVuZAoJCVN3YXBzW09iamVjdF0gPSBEYXRhCgllbmQKCgktLS8vIEludm9rZSBHZXRTd2FwcyBmdW5jdGlvbgoJRnVuYyhJbnRlcmZhY2UpCgoJcmV0dXJuIFN3YXBzCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpQaWNrVmFyaWFibGVOYW1lKCk6IHN0cmluZwoJbG9jYWwgTmFtZXMgPSBDb25maWcuVmFyaWFibGVOYW1lcwoJcmV0dXJuIE5hbWVzW21hdGgucmFuZG9tKDEsICNOYW1lcyldCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpOZXdQYXJzZXIoRXh0cmE6IHRhYmxlKQoJbG9jYWwgVmFyaWFibGVOYW1lID0gc2VsZjpQaWNrVmFyaWFibGVOYW1lKCkKCWxvY2FsIFN3YXBzID0gc2VsZjpHZXRTd2FwcygpCgoJbG9jYWwgQ29uZmlndXJhdGlvbiA9IHsKCQlWYXJpYWJsZUJhc2UgPSBWYXJpYWJsZU5hbWUsCgkJU3dhcHMgPSBTd2FwcywKCQlJbmRleEZ1bmMgPSBmdW5jdGlvbiguLi4pCgkJCXJldHVybiBIb29rOkluZGV4KC4uLikKCQllbmQsCgl9CgoJLS0vLyBNZXJnZSBleHRyYSBjb25maWd1cmF0aW9uCglNZXJnZShDb25maWd1cmF0aW9uLCBFeHRyYSkKCgktLS8vIENyZWF0ZSBuZXcgcGFyc2VyIGluc3RhbmNlCglyZXR1cm4gUGFyc2VyTW9kdWxlOk5ldyhDb25maWd1cmF0aW9uKQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246SW5kZW50KEluZGVudFN0cmluZzogc3RyaW5nLCBMaW5lOiBzdHJpbmcpCglyZXR1cm4gYHtJbmRlbnRTdHJpbmd9e0xpbmV9YAplbmQKCnR5cGUgQ2FsbEluZm8gPSB7CglBcmd1bWVudHM6IHRhYmxlLAoJSW5kZW50OiBudW1iZXIsCglSZW1vdGVWYXJpYWJsZTogc3RyaW5nCn0KZnVuY3Rpb24gR2VuZXJhdGlvbjpDYWxsUmVtb3RlU2NyaXB0KERhdGEsIEluZm86IENhbGxJbmZvKTogc3RyaW5nCglsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MKCglsb2NhbCBSZW1vdGVWYXJpYWJsZSA9IEluZm8uUmVtb3RlVmFyaWFibGUKCWxvY2FsIEluZGVudCA9IEluZm8uSW5kZW50IG9yIDAKCWxvY2FsIE1vZHVsZSA9IEluZm8uTW9kdWxlCgoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcwoJbG9jYWwgUGFyc2VyID0gTW9kdWxlLlBhcnNlcgoJbG9jYWwgTm9WYXJpYWJsZXMgPSBEYXRhLk5vVmFyaWFibGVzCgoJbG9jYWwgSW5kZW50U3RyaW5nID0gc2VsZjpNYWtlSW5kZW50KEluZGVudCkKCgktLS8vIFBhcnNlIGFyZ3VtZW50cwoJbG9jYWwgUGFyc2VkQXJncywgSXRlbXNDb3VudCwgSXNBcnJheSA9IFBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7CgkJTm9CcmFja2V0cyA9IHRydWUsCgkJTm9WYXJpYWJsZXMgPSBOb1ZhcmlhYmxlcywKCQlUYWJsZSA9IEFyZ3MsCgkJSW5kZW50ID0gSW5kZW50Cgl9KQoKCS0tLy8gQ3JlYXRlIHRhYmxlIHZhcmlhYmxlIGlmIG5vdCBhbiBhcnJheQoJaWYgbm90IElzQXJyYXkgb3IgTm9WYXJpYWJsZXMgdGhlbgoJCVBhcnNlZEFyZ3MgPSBWYXJpYWJsZXM6TWFrZVZhcmlhYmxlKHsKCQkJVmFsdWUgPSAoInslc30iKTpmb3JtYXQoUGFyc2VkQXJncyksCgkJCUNvbW1lbnQgPSBub3QgSXNBcnJheSBhbmQgIkFyZ3VtZW50cyBhcmVuJ3Qgb3JkZXJlZCIgb3IgbmlsLAoJCQlOYW1lID0gIlJlbW90ZUFyZ3MiLAoJCQlDbGFzcyA9ICJSZW1vdGUiCgkJfSkKCWVuZAoKCS0tLy8gV3JhcCBpbiBhIHVucGFjayBpZiB0aGUgdGFibGUgaXMgYSBkaWN0CglpZiBJdGVtc0NvdW50ID4gMCBhbmQgbm90IElzQXJyYXkgdGhlbgoJCVBhcnNlZEFyZ3MgPSBgdW5wYWNrKHtQYXJzZWRBcmdzfSwgMSwgdGFibGUubWF4bih7UGFyc2VkQXJnc30pKWAKCWVuZAoKCS0tLy8gRmlyZXNpZ25hbCBzY3JpcHQgZm9yIGNsaWVudCByZWNpZXZlcwoJaWYgSXNSZWNlaXZlIHRoZW4KCQlsb2NhbCBTZWNvbmQgPSBJdGVtc0NvdW50IDw9IDAgYW5kICIiIG9yIGAsIHtQYXJzZWRBcmdzfWAKCQlsb2NhbCBTaWduYWwgPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWAKCgkJbG9jYWwgQ29kZSA9IGAtLSBUaGlzIGRhdGEgd2FzIHJlY2VpdmVkIGZyb20gdGhlIHNlcnZlcmAKCQlQYXJzZWRBcmdzID0gc2VsZjpJbmRlbnQoSW5kZW50U3RyaW5nLCBDb2RlKQoJCUNvZGUgLi49IGBcbntJbmRlbnRTdHJpbmd9ZmlyZXNpZ25hbCh7U2lnbmFsfXtTZWNvbmR9KWAKCQkKCQlyZXR1cm4gQ29kZQoJZW5kCgkKCS0tLy8gUmVtb3RlIGludm9rZSBzY3JpcHQKCXJldHVybiBge1JlbW90ZVZhcmlhYmxlfTp7TWV0aG9kfSh7UGFyc2VkQXJnc30pYAplbmQKCi0tLy8gVmFyaWFibGVzOiAlVmFyaWFibGVOYW1lJQpmdW5jdGlvbiBHZW5lcmF0aW9uOkFwcGx5VmFyaWFibGVzKFN0cmluZzogc3RyaW5nLCBWYXJpYWJsZXM6IHRhYmxlLCAuLi4pOiBzdHJpbmcKCWZvciBWYXJpYWJsZSwgVmFsdWUgaW4gVmFyaWFibGVzIGRvCgkJLS0vLyBJbnZva2UgdmFsdWUgZnVuY3Rpb24KCQlpZiB0eXBlb2YoVmFsdWUpID09ICJmdW5jdGlvbiIgdGhlbgoJCQlWYWx1ZSA9IFZhbHVlKC4uLikKCQllbmQKCgkJU3RyaW5nID0gU3RyaW5nOmdzdWIoYCUle1ZhcmlhYmxlfSUlYCwgZnVuY3Rpb24oKQoJCQlyZXR1cm4gVmFsdWUKCQllbmQpCgllbmQKCXJldHVybiBTdHJpbmcKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VJbmRlbnQoSW5kZW50OiBudW1iZXIpCglyZXR1cm4gc3RyaW5nLnJlcCgiCSIsIEluZGVudCkKZW5kCgp0eXBlIFNjcmlwdERhdGEgPSB7CglWYXJpYWJsZXM6IHRhYmxlLAoJTWV0YU1ldGhvZDogc3RyaW5nCn0KZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlQ2FsbENvZGUoU2NyaXB0VHlwZTogc3RyaW5nLCBEYXRhOiBTY3JpcHREYXRhKTogc3RyaW5nCglsb2NhbCBTY3JpcHRUZW1wbGF0ZXMgPSBzZWxmLlNjcmlwdFRlbXBsYXRlcwoJbG9jYWwgVGVtcGxhdGUgPSBTY3JpcHRUZW1wbGF0ZXNbU2NyaXB0VHlwZV0KCglhc3NlcnQoVGVtcGxhdGUsIGB7U2NyaXB0VHlwZX0gaXMgbm90IGEgdmFsaWQgc2NyaXB0IHR5cGUhYCkKCglsb2NhbCBWYXJpYWJsZXMgPSBEYXRhLlZhcmlhYmxlcwoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoJbG9jYWwgTWV0YU1ldGhvZHMgPSB7Il9faW5kZXgiLCAiX19uYW1lY2FsbCIsICJDb25uZWN0In0KCglsb2NhbCBmdW5jdGlvbiBDb21waWxlKFRlbXBsYXRlOiB0YWJsZSk6IHN0cmluZwoJCWxvY2FsIE91dCA9ICIiCgoJCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRlbXBsYXRlIGRvCgkJCS0tLy8gTWV0YU1ldGhvZCBjaGVjawoJCQlsb2NhbCBJc01ldGFUeXBlT25seSA9IHRhYmxlLmZpbmQoTWV0YU1ldGhvZHMsIEtleSkKCQkJaWYgSXNNZXRhVHlwZU9ubHkgdGhlbgoJCQkJaWYgS2V5ID09IE1ldGFNZXRob2QgdGhlbgoJCQkJCWxvY2FsIExpbmUgPSBDb21waWxlKFZhbHVlKQoJCQkJCU91dCAuLj0gTGluZQoJCQkJZW5kCgkJCQljb250aW51ZQoJCQllbmQKCgkJCS0tLy8gSW5mb3JtYXRpb24KCQkJbG9jYWwgQ29udGVudCwgSW5kZW50ID0gVmFsdWVbMV0sIFZhbHVlWzJdIG9yIDAKCQkJSW5kZW50ID0gbWF0aC5jbGFtcChJbmRlbnQtMSwgMCwgOTk5OSkKCgkJCS0tLy8gTWFrZSBsaW5lCgkJCWxvY2FsIExpbmUgPSBzZWxmOkFwcGx5VmFyaWFibGVzKENvbnRlbnQsIFZhcmlhYmxlcywgSW5kZW50KQoJCQlsb2NhbCBJbmRlbnRTdHJpbmcgPSBzZWxmOk1ha2VJbmRlbnQoSW5kZW50KQoKCQkJLS0vLyBBcHBlbmQgdG8gY29kZQoJCQlPdXQgLi49IGB7SW5kZW50U3RyaW5nfXtMaW5lfVxuYAoJCWVuZAoKCQlyZXR1cm4gT3V0CgllbmQKCQoJcmV0dXJuIENvbXBpbGUoVGVtcGxhdGUpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpSZW1vdGVTY3JpcHQoTW9kdWxlLCBEYXRhOiBSZW1vdGVEYXRhLCBTY3JpcHRUeXBlOiBzdHJpbmcpOiBzdHJpbmcKCS0tLy8gVW5wYWNrIGRhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoKCS0tLy8gUmVtb3RlIGluZm8KCWxvY2FsIENsYXNzTmFtZSA9IEhvb2s6SW5kZXgoUmVtb3RlLCAiQ2xhc3NOYW1lIikKCWxvY2FsIElzTmlsUGFyZW50ID0gSG9vazpJbmRleChSZW1vdGUsICJQYXJlbnQiKSA9PSBuaWwKCQoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcwoJbG9jYWwgRm9ybWF0dGVyID0gTW9kdWxlLkZvcm1hdHRlcgoJCgktLS8vIFByZS1yZW5kZXIgdmFyaWFibGVzCglWYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKEFyZ3MsIHsiSW5zdGFuY2UifSkKCgktLS8vIENyZWF0ZSByZW1vdGUgdmFyaWFibGUKCWxvY2FsIFJlbW90ZVZhcmlhYmxlID0gVmFyaWFibGVzOk1ha2VWYXJpYWJsZSh7CgkJVmFsdWUgPSBGb3JtYXR0ZXI6Rm9ybWF0KFJlbW90ZSwgewoJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQl9KSwKCQlDb21tZW50ID0gYHtDbGFzc05hbWV9IHtJc05pbFBhcmVudCBhbmQgInwgUmVtb3RlIHBhcmVudCBpcyBuaWwiIG9yICIifWAsCgkJTmFtZSA9IEZvcm1hdHRlcjpNYWtlTmFtZShSZW1vdGUpLAoJCUxvb2t1cCA9IFJlbW90ZSwKCQlDbGFzcyA9ICJSZW1vdGUiCgl9KQoKCS0tLy8gR2VuZXJhdGUgY2FsbCBzY3JpcHQKCWxvY2FsIENhbGxDb2RlID0gc2VsZjpNYWtlQ2FsbENvZGUoU2NyaXB0VHlwZSwgewoJCVZhcmlhYmxlcyA9IHsKCQkJWyJSZW1vdGVDYWxsIl0gPSBmdW5jdGlvbihJbmRlbnQ6IG51bWJlcikKCQkJCXJldHVybiBzZWxmOkNhbGxSZW1vdGVTY3JpcHQoRGF0YSwgewoJCQkJCVJlbW90ZVZhcmlhYmxlID0gUmVtb3RlVmFyaWFibGUsCgkJCQkJSW5kZW50ID0gSW5kZW50LAoJCQkJCU1vZHVsZSA9IE1vZHVsZQoJCQkJfSkKCQkJZW5kLAoJCQlbIlJlbW90ZSJdID0gUmVtb3RlVmFyaWFibGUsCgkJCVsiTWV0aG9kIl0gPSBNZXRob2QsCgkJCVsiU2lnbmFsIl0gPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWAKCQl9LAoJCU1ldGFNZXRob2QgPSBNZXRhTWV0aG9kCgl9KQoJCgktLS8vIE1ha2UgY29kZQoJbG9jYWwgQ29kZSA9IHNlbGY6R2V0QmFzZShNb2R1bGUpCglyZXR1cm4gYHtDb2RlfVxue0NhbGxDb2RlfWAKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkNvbm5lY3Rpb25zVGFibGUoU2lnbmFsOiBSQlhTY3JpcHRTaWduYWwpOiB0YWJsZQoJbG9jYWwgQ29ubmVjdGlvbnMgPSBnZXRjb25uZWN0aW9ucyhTaWduYWwpCglsb2NhbCBEYXRhQXJyYXkgPSB7fQoKCWZvciBfLCBDb25uZWN0aW9uIGluIG5leHQsIENvbm5lY3Rpb25zIGRvCgkJbG9jYWwgRnVuY3Rpb24gPSBDb25uZWN0aW9uLkZ1bmN0aW9uCgkJbG9jYWwgU2NyaXB0ID0gcmF3Z2V0KGdldGZlbnYoRnVuY3Rpb24pLCAic2NyaXB0IikKCgkJLS0vLyBTa2lwIGlmIHNlbGYKCQlpZiBTY3JpcHQgPT0gVGhpc1NjcmlwdCB0aGVuIGNvbnRpbnVlIGVuZAoKCQktLS8vIENvbm5lY3Rpb24gZGF0YQoJCWxvY2FsIERhdGEgPSB7CgkJCUZ1bmN0aW9uID0gRnVuY3Rpb24sCgkJCVN0YXRlID0gQ29ubmVjdGlvbi5TdGF0ZSwKCQkJU2NyaXB0ID0gU2NyaXB0CgkJfQoKCQl0YWJsZS5pbnNlcnQoRGF0YUFycmF5LCBEYXRhKQoJZW5kCgoJcmV0dXJuIERhdGFBcnJheQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBUYWJsZTogdGFibGUpOiBzdHJpbmcKCS0tLy8gUHJlLXJlbmRlciB2YXJpYWJsZXMKCU1vZHVsZS5WYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKFRhYmxlLCB7Ikluc3RhbmNlIn0pCgoJLS0vLyBQYXJzZSBhcmd1bWVudHMKCWxvY2FsIFBhcnNlZFRhYmxlID0gTW9kdWxlLlBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7CgkJVGFibGUgPSBUYWJsZQoJfSkKCgktLS8vIEdlbmVyYXRlIHNjcmlwdAoJbG9jYWwgQ29kZSwgTm9WYXJpYWJsZXMgPSBzZWxmOkdldEJhc2UoTW9kdWxlKQoJbG9jYWwgU2VwZXJhdG9yID0gTm9WYXJpYWJsZXMgYW5kICIiIG9yICJcbiIKCUNvZGUgLi49IGB7U2VwZXJhdG9yfXJldHVybiB7UGFyc2VkVGFibGV9YAoKCXJldHVybiBDb2RlCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlVHlwZXNUYWJsZShUYWJsZTogdGFibGUpOiB0YWJsZQoJbG9jYWwgVHlwZXMgPSB7fQoKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRhYmxlIGRvCgkJbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKCQlpZiBUeXBlID09ICJ0YWJsZSIgdGhlbgoJCQlUeXBlID0gc2VsZjpNYWtlVHlwZXNUYWJsZShWYWx1ZSkKCQllbmQKCgkJVHlwZXNbS2V5XSA9IFR5cGUKCWVuZAoKCXJldHVybiBUeXBlcwplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246Q29ubmVjdGlvbkluZm8oUmVtb3RlOiBJbnN0YW5jZSwgQ2xhc3NEYXRhOiB0YWJsZSk6IHRhYmxlPwoJbG9jYWwgUmVjZWl2ZU1ldGhvZHMgPSBDbGFzc0RhdGEuUmVjZWl2ZQoJaWYgbm90IFJlY2VpdmVNZXRob2RzIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIENvbm5lY3Rpb25zID0ge30KCWZvciBfLCBNZXRob2Q6IHN0cmluZyBpbiBuZXh0LCBSZWNlaXZlTWV0aG9kcyBkbwoJCXBjYWxsKGZ1bmN0aW9uKCkgLS0gVE9ETzogR0VUQ0FMTEJBQ0tWQUxVRQoJCQlsb2NhbCBTaWduYWwgPSBIb29rOkluZGV4KFJlbW90ZSwgTWV0aG9kKQoJCQlDb25uZWN0aW9uc1tNZXRob2RdID0gc2VsZjpDb25uZWN0aW9uc1RhYmxlKFNpZ25hbCkKCQllbmQpCgllbmQKCglyZXR1cm4gQ29ubmVjdGlvbnMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkFkdmFuY2VkSW5mbyhNb2R1bGUsIERhdGE6IHRhYmxlKTogc3RyaW5nCgktLS8vIFVucGFjayByZW1vdGUgZGF0YQoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoJbG9jYWwgRnVuY3Rpb24gPSBEYXRhLkNhbGxpbmdGdW5jdGlvbgoJbG9jYWwgQ2xhc3NEYXRhID0gRGF0YS5DbGFzc0RhdGEKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgU2NyaXB0ID0gRGF0YS5DYWxsaW5nU2NyaXB0Cglsb2NhbCBTb3VyY2VTY3JpcHQgPSBEYXRhLlNvdXJjZVNjcmlwdAoJbG9jYWwgSWQgPSBEYXRhLklkCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCgkKCS0tLy8gQWR2YW5jZWQgaW5mbyB0YWJsZSBiYXNlCglsb2NhbCBGdW5jdGlvbkluZm8gPSB7CgkJWyJDYWxsZXIiXSA9IHsKCQkJWyJTb3VyY2VTY3JpcHQiXSA9IFNvdXJjZVNjcmlwdCwKCQkJWyJDYWxsaW5nU2NyaXB0Il0gPSBTY3JpcHQsCgkJCVsiQ2FsbGluZ0Z1bmN0aW9uIl0gPSBGdW5jdGlvbgoJCX0sCgkJWyJSZW1vdGUiXSA9IHsKCQkJWyJSZW1vdGUiXSA9IFJlbW90ZSwKCQkJWyJSZW1vdGVJRCJdID0gSWQsCgkJCVsiTWV0aG9kIl0gPSBNZXRob2QsCgkJCVsiQ29ubmVjdGlvbnMiXSA9IHNlbGY6Q29ubmVjdGlvbkluZm8oUmVtb3RlLCBDbGFzc0RhdGEpCgkJfSwKCQlbIkFyZ3VtZW50cyJdID0gewoJCQlbIkxlbmd0aCJdID0gI0FyZ3MsCgkJCVsiVHlwZXMiXSA9IHNlbGY6TWFrZVR5cGVzVGFibGUoQXJncyksCgkJfSwKCQlbIk1ldGFNZXRob2QiXSA9IE1ldGFNZXRob2QsCgkJWyJJc0FjdG9yIl0gPSBEYXRhLklzQWN0b3IsCgl9CgoJLS0vLyBTb21lIGNsb3N1cmVzIG1heSBub3QgYmUgbHVhCglpZiBpc2xjbG9zdXJlKEZ1bmN0aW9uKSB0aGVuCgkJRnVuY3Rpb25JbmZvWyJVcFZhbHVlcyJdID0gZGVidWcuZ2V0dXB2YWx1ZXMoRnVuY3Rpb24pCgkJRnVuY3Rpb25JbmZvWyJDb25zdGFudHMiXSA9IGRlYnVnLmdldGNvbnN0YW50cyhGdW5jdGlvbikKCWVuZAoKCS0tLy8gR2VuZXJhdGUgc2NyaXB0CglyZXR1cm4gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIEZ1bmN0aW9uSW5mbykKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkR1bXBMb2dzKExvZ3M6IHRhYmxlKTogc3RyaW5nCglsb2NhbCBCYXNlRGF0YQoJbG9jYWwgUGFyc2VkID0gewoJCVJlbW90ZSA9IG5pbCwKCQlDYWxscyA9IHt9Cgl9CgoJLS0vLyBDcmVhdGUgbmV3IHBhcnNlciBpbnN0YW5jZQoJbG9jYWwgTW9kdWxlID0gR2VuZXJhdGlvbjpOZXdQYXJzZXIoKQoKCWZvciBfLCBEYXRhIGluIExvZ3MgZG8KCQlsb2NhbCBDYWxscyA9IFBhcnNlZC5DYWxscwoJCWxvY2FsIFRhYmxlID0gewoJCQlBcmdzID0gRGF0YS5BcmdzLAoJCQlUaW1lc3RhbXAgPSBEYXRhLlRpbWVzdGFtcCwKCQkJUmV0dXJuVmFsdWVzID0gRGF0YS5SZXR1cm5WYWx1ZXMsCgkJCU1ldGhvZCA9IERhdGEuTWV0aG9kLAoJCQlNZXRhTWV0aG9kID0gRGF0YS5NZXRhTWV0aG9kLAoJCQlDYWxsaW5nU2NyaXB0ID0gRGF0YS5DYWxsaW5nU2NyaXB0LAoJCX0KCgkJLS0vLyBBcHBlbmQKCQl0YWJsZS5pbnNlcnQoQ2FsbHMsIFRhYmxlKQoKCQktLS8vIFNldCBCYXNlRGF0YQoJCWlmIG5vdCBCYXNlRGF0YSB0aGVuCgkJCUJhc2VEYXRhID0gRGF0YQoJCWVuZAoJZW5kCgoJLS0vLyBCYXNlZGF0YSBtZXJnZQoJUGFyc2VkLlJlbW90ZSA9IEJhc2VEYXRhLlJlbW90ZQoKCS0tLy8gQ29tcGlsZSBhbmQgc2F2ZQoJbG9jYWwgT3V0cHV0ID0gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIFBhcnNlZCkKCWxvY2FsIEZpbGVQYXRoID0gc2VsZjpXcml0ZUR1bXAoT3V0cHV0KQoJCglyZXR1cm4gRmlsZVBhdGgKZW5kCgpyZXR1cm4gR2VuZXJhdGlvbgo="},
	Communication = {"base64", "dHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKLS0vLyBNb2R1bGUKbG9jYWwgTW9kdWxlID0gewogICAgQ29tbUNhbGxiYWNrcyA9IHt9Cn0KCmxvY2FsIENvbW1XcmFwcGVyID0ge30KQ29tbVdyYXBwZXIuX19pbmRleCA9IENvbW1XcmFwcGVyCgotLS8vIFNlcnZpY2VzCmxvY2FsIENvcmVHdWkKCi0tLy8gTW9kdWxlcwpsb2NhbCBIb29rCmxvY2FsIENoYW5uZWwKbG9jYWwgQ29uZmlnCmxvY2FsIFByb2Nlc3MKCmZ1bmN0aW9uIE1vZHVsZTpJbml0KERhdGEpCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzCiAgICBsb2NhbCBTZXJ2aWNlcyA9IERhdGEuU2VydmljZXMKCiAgICBIb29rID0gTW9kdWxlcy5Ib29rCiAgICBQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCiAgICBDb25maWcgPSBNb2R1bGVzLkNvbmZpZyBvciBDb25maWcKICAgIENvcmVHdWkgPSBTZXJ2aWNlcy5Db3JlR3VpCmVuZAoKZnVuY3Rpb24gQ29tbVdyYXBwZXI6RmlyZSguLi4pCiAgICBsb2NhbCBRdWV1ZSA9IHNlbGYuUXVldWUKICAgIHRhYmxlLmluc2VydChRdWV1ZSwgey4uLn0pCmVuZAoKZnVuY3Rpb24gQ29tbVdyYXBwZXI6UHJvY2Vzc0FyZ3VtZW50cyhBcmd1bWVudHMpIAogICAgbG9jYWwgQ2hhbm5lbCA9IHNlbGYuQ2hhbm5lbAogICAgQ2hhbm5lbDpGaXJlKFByb2Nlc3M6VW5wYWNrKEFyZ3VtZW50cykpCmVuZAoKZnVuY3Rpb24gQ29tbVdyYXBwZXI6UHJvY2Vzc1F1ZXVlKCkKICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQoKICAgIGZvciBJbmRleCA9IDEsICNRdWV1ZSBkbwogICAgICAgIGxvY2FsIEFyZ3VtZW50cyA9IHRhYmxlLnJlbW92ZShRdWV1ZSkKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIHNlbGY6UHJvY2Vzc0FyZ3VtZW50cyhBcmd1bWVudHMpIAogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCmZ1bmN0aW9uIENvbW1XcmFwcGVyOkJlZ2luUXVldWVTZXJ2aWNlKCkKICAgIGNvcm91dGluZS53cmFwKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSB3YWl0KCkgZG8KICAgICAgICAgICAgc2VsZjpQcm9jZXNzUXVldWUoKQogICAgICAgIGVuZAogICAgZW5kKSgpCmVuZAoKZnVuY3Rpb24gTW9kdWxlOk5ld0NvbW1XcmFwKENoYW5uZWw6IEJpbmRhYmxlRXZlbnQpCiAgICBsb2NhbCBCYXNlID0gewogICAgICAgIFF1ZXVlID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gInYifSksCiAgICAgICAgQ2hhbm5lbCA9IENoYW5uZWwsCiAgICAgICAgRXZlbnQgPSBDaGFubmVsLkV2ZW50CiAgICB9CgogICAgLS0vLyBDcmVhdGUgbmV3IHdyYXBwZXIgY2xhc3MKICAgIGxvY2FsIFdyYXBwZWQgPSBzZXRtZXRhdGFibGUoQmFzZSwgQ29tbVdyYXBwZXIpCiAgICBXcmFwcGVkOkJlZ2luUXVldWVTZXJ2aWNlKCkKCiAgICByZXR1cm4gV3JhcHBlZAplbmQKCmZ1bmN0aW9uIE1vZHVsZTpNYWtlRGVidWdJZEhhbmRsZXIoKTogQmluZGFibGVGdW5jdGlvbgogICAgLS0vLyBVc2luZyBCaW5kYWJsZUZ1bmN0aW9uIGFzIGl0IGRvZXMgbm90IHJlcXVpcmUgYSB0aHJlYWQgcGVybWlzc2lvbiBjaGFuZ2UKICAgIGxvY2FsIFJlbW90ZSA9IEluc3RhbmNlLm5ldygiQmluZGFibGVGdW5jdGlvbiIpCiAgICBmdW5jdGlvbiBSZW1vdGUuT25JbnZva2UoT2JqZWN0OiBJbnN0YW5jZSk6IHN0cmluZwogICAgICAgIHJldHVybiBPYmplY3Q6R2V0RGVidWdJZCgpCiAgICBlbmQKCiAgICBzZWxmLkRlYnVnSWRSZW1vdGUgPSBSZW1vdGUKICAgIHNlbGYuRGVidWdJZEludm9rZSA9IFJlbW90ZS5JbnZva2UKCiAgICByZXR1cm4gUmVtb3RlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkdldERlYnVnSWQoT2JqZWN0OiBJbnN0YW5jZSk6IHN0cmluZwogICAgbG9jYWwgSW52b2tlID0gc2VsZi5EZWJ1Z0lkSW52b2tlCiAgICBsb2NhbCBSZW1vdGUgPSBzZWxmLkRlYnVnSWRSZW1vdGUKCXJldHVybiBJbnZva2UoUmVtb3RlLCBPYmplY3QpCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkdldEhpZGRlblBhcmVudCgpOiBJbnN0YW5jZQogICAgLS0vLyBVc2UgZ2V0aHVpIGlmIGl0IGV4aXN0cwogICAgaWYgZ2V0aHVpIHRoZW4gcmV0dXJuIGdldGh1aSgpIGVuZAogICAgcmV0dXJuIENvcmVHdWkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6Q3JlYXRlQ29tbUNoYW5uZWwoKTogKG51bWJlciwgQmluZGFibGVFdmVudCkKICAgIC0tLy8gVXNlIG5hdGl2ZSBpZiBpdCBleGlzdHMKICAgIGxvY2FsIEZvcmNlID0gQ29uZmlnLkZvcmNlVXNlQ3VzdG9tQ29tbQogICAgaWYgY3JlYXRlX2NvbW1fY2hhbm5lbCBhbmQgbm90IEZvcmNlIHRoZW4KICAgICAgICByZXR1cm4gY3JlYXRlX2NvbW1fY2hhbm5lbCgpCiAgICBlbmQKCiAgICBsb2NhbCBQYXJlbnQgPSBzZWxmOkdldEhpZGRlblBhcmVudCgpCiAgICBsb2NhbCBDaGFubmVsSWQgPSBtYXRoLnJhbmRvbSgxLCAxMDAwMDAwMCkKCiAgICAtLS8vIEJpbmRhYmxlRXZlbnQKICAgIGxvY2FsIENoYW5uZWwgPSBJbnN0YW5jZS5uZXcoIkJpbmRhYmxlRXZlbnQiLCBQYXJlbnQpCiAgICBDaGFubmVsLk5hbWUgPSBDaGFubmVsSWQKCiAgICByZXR1cm4gQ2hhbm5lbElkLCBDaGFubmVsCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkdldENvbW1DaGFubmVsKENoYW5uZWxJZDogbnVtYmVyKTogQmluZGFibGVFdmVudD8KICAgIC0tLy8gVXNlIG5hdGl2ZSBpZiBpdCBleGlzdHMKICAgIGxvY2FsIEZvcmNlID0gQ29uZmlnLkZvcmNlVXNlQ3VzdG9tQ29tbQogICAgaWYgZ2V0X2NvbW1fY2hhbm5lbCBhbmQgbm90IEZvcmNlIHRoZW4KICAgICAgICBsb2NhbCBDaGFubmVsID0gZ2V0X2NvbW1fY2hhbm5lbChDaGFubmVsSWQpCiAgICAgICAgcmV0dXJuIENoYW5uZWwsIGZhbHNlCiAgICBlbmQKCiAgICBsb2NhbCBQYXJlbnQgPSBzZWxmOkdldEhpZGRlblBhcmVudCgpCiAgICBsb2NhbCBDaGFubmVsID0gUGFyZW50OkZpbmRGaXJzdENoaWxkKENoYW5uZWxJZCkKCiAgICAtLS8vIFdyYXAgdGhlIGNoYW5uZWwgKFByZXZlbnRzIHRocmVhZCBwZXJtaXNzaW9uIGVycm9ycykKICAgIGxvY2FsIFdyYXBwZWQgPSBzZWxmOk5ld0NvbW1XcmFwKENoYW5uZWwpCiAgICByZXR1cm4gV3JhcHBlZCwgdHJ1ZQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpDaGVja1ZhbHVlKFZhbHVlLCBJbmJvdW5kOiBib29sZWFuPykKICAgICAtLS8vIE5vIHNlcmlhbGl6aW5nICBuZWVkZWQKICAgIGlmIHR5cGVvZihWYWx1ZSkgfj0gInRhYmxlIiB0aGVuIAogICAgICAgIHJldHVybiBWYWx1ZSAKICAgIGVuZAogICAKICAgIC0tLy8gRGVzZXJpYWxpemUKICAgIGlmIEluYm91bmQgdGhlbgogICAgICAgIHJldHVybiBzZWxmOkRlc2VyaWFsaXplVGFibGUoVmFsdWUpCiAgICBlbmQKCiAgICAtLS8vIFNlcmlhbGl6ZQogICAgcmV0dXJuIHNlbGY6U2VyaWFsaXplVGFibGUoVmFsdWUpCmVuZAoKZnVuY3Rpb24gTW9kdWxlOk1ha2VQYWNrZXQoSW5kZXgsIFZhbHVlKTogdGFibGUKICAgIHJldHVybiB7CiAgICAgICAgSW5kZXggPSBzZWxmOkNoZWNrVmFsdWUoSW5kZXgpLCAKICAgICAgICBWYWx1ZSA9IHNlbGY6Q2hlY2tWYWx1ZShWYWx1ZSkKICAgIH0KZW5kCgpmdW5jdGlvbiBNb2R1bGU6UmVhZFBhY2tldChQYWNrZXQ6IHRhYmxlKTogKGFueSwgYW55KQogICAgbG9jYWwgS2V5ID0gc2VsZjpDaGVja1ZhbHVlKFBhY2tldC5JbmRleCwgdHJ1ZSkKICAgIGxvY2FsIFZhbHVlID0gc2VsZjpDaGVja1ZhbHVlKFBhY2tldC5WYWx1ZSwgdHJ1ZSkKICAgIHJldHVybiBLZXksIFZhbHVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNlcmlhbGl6ZVRhYmxlKFRhYmxlOiB0YWJsZSk6IHRhYmxlCiAgICBsb2NhbCBTZXJpYWxpemVkID0ge30KICAgIGZvciBJbmRleCwgVmFsdWUgaW4gbmV4dCwgVGFibGUgZG8KICAgICAgICBsb2NhbCBQYWNrZXQgPSBzZWxmOk1ha2VQYWNrZXQoSW5kZXgsIFZhbHVlKQogICAgICAgIHRhYmxlLmluc2VydChTZXJpYWxpemVkLCBQYWNrZXQpCiAgICBlbmQKICAgIHJldHVybiBTZXJpYWxpemVkCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkRlc2VyaWFsaXplVGFibGUoU2VyaWFsaXplZDogdGFibGUpOiB0YWJsZQogICAgbG9jYWwgVGFibGUgPSB7fQogICAgZm9yIF8sIFBhY2tldCBpbiBuZXh0LCBTZXJpYWxpemVkIGRvCiAgICAgICAgbG9jYWwgSW5kZXgsIFZhbHVlID0gc2VsZjpSZWFkUGFja2V0KFBhY2tldCkKICAgICAgICBpZiBub3QgSW5kZXggdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgVGFibGVbSW5kZXhdID0gVmFsdWUKICAgIGVuZAogICAgcmV0dXJuIFRhYmxlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogbnVtYmVyKQogICAgQ2hhbm5lbCA9IE5ld0NoYW5uZWwKZW5kCgpmdW5jdGlvbiBNb2R1bGU6V2FybiguLi4pCiAgICBzZWxmOkNvbW11bmljYXRlKCJXYXJuIiwgLi4uKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpRdWV1ZUxvZyhEYXRhKQogICAgc2VsZjpDb21tdW5pY2F0ZSgiUXVldWVMb2ciLCBEYXRhKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpBZGRDb21tQ2FsbGJhY2soVHlwZTogc3RyaW5nLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55KQogICAgbG9jYWwgQ29tbUNhbGxiYWNrcyA9IHNlbGYuQ29tbUNhbGxiYWNrcwogICAgQ29tbUNhbGxiYWNrc1tUeXBlXSA9IENhbGxiYWNrCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkdldENvbW1DYWxsYmFjayhUeXBlOiBzdHJpbmcpOiAoLi4uYW55KSAtPiAuLi5hbnkKICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MKICAgIHJldHVybiBDb21tQ2FsbGJhY2tzW1R5cGVdCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNoYW5uZWxJbmRleChDaGFubmVsLCBQcm9wZXJ0eTogc3RyaW5nKQogICAgaWYgdHlwZW9mKENoYW5uZWwpID09ICJJbnN0YW5jZSIgdGhlbgogICAgICAgIHJldHVybiBIb29rOkluZGV4KENoYW5uZWwsIFByb3BlcnR5KQogICAgZW5kCgogICAgLS0vLyBTb21lIGV4ZWN1dG9ycyByZXR1cm4gYSBVc2VyRGF0YSB0eXBlCiAgICByZXR1cm4gQ2hhbm5lbFtQcm9wZXJ0eV0KZW5kCgpmdW5jdGlvbiBNb2R1bGU6Q29tbXVuaWNhdGUoLi4uKQogICAgbG9jYWwgRmlyZSA9IHNlbGY6Q2hhbm5lbEluZGV4KENoYW5uZWwsICJGaXJlIikKICAgIEZpcmUoQ2hhbm5lbCwgLi4uKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpBZGRDb25uZWN0aW9uKENhbGxiYWNrKTogUkJYU2NyaXB0Q29ubmVjdGlvbgogICAgbG9jYWwgRXZlbnQgPSBzZWxmOkNoYW5uZWxJbmRleChDaGFubmVsLCAiRXZlbnQiKQogICAgcmV0dXJuIEV2ZW50OkNvbm5lY3QoQ2FsbGJhY2spCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkFkZFR5cGVDYWxsYmFjayhUeXBlOiBzdHJpbmcsIENhbGxiYWNrKTogUkJYU2NyaXB0Q29ubmVjdGlvbgogICAgbG9jYWwgRXZlbnQgPSBzZWxmOkNoYW5uZWxJbmRleChDaGFubmVsLCAiRXZlbnQiKQogICAgcmV0dXJuIEV2ZW50OkNvbm5lY3QoZnVuY3Rpb24oUmVjaXZlZFR5cGU6IHN0cmluZywgLi4uKQogICAgICAgIGlmIFJlY2l2ZWRUeXBlIH49IFR5cGUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgQ2FsbGJhY2soLi4uKQogICAgZW5kKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpBZGRUeXBlQ2FsbGJhY2tzKFR5cGVzOiB0YWJsZSkKICAgIGZvciBUeXBlOiBzdHJpbmcsIENhbGxiYWNrIGluIG5leHQsIFR5cGVzIGRvCiAgICAgICAgc2VsZjpBZGRUeXBlQ2FsbGJhY2soVHlwZSwgQ2FsbGJhY2spCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkRGVmYXVsdENhbGxiYWNrcyhFdmVudDogQmluZGFibGVFdmVudCkKICAgIHNlbGY6QWRkQ29tbUNhbGxiYWNrKCJXYXJuIiwgZnVuY3Rpb24oLi4uKQogICAgICAgIHdhcm4oLi4uKQogICAgZW5kKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpDcmVhdGVDaGFubmVsKCk6IG51bWJlcgogICAgbG9jYWwgQ2hhbm5lbElELCBFdmVudCA9IHNlbGY6Q3JlYXRlQ29tbUNoYW5uZWwoKQoKICAgIC0tLy8gQ29ubmVjdCBHZXRDb21tQ2FsbGJhY2sgZnVuY3Rpb24KICAgIEV2ZW50LkV2ZW50OkNvbm5lY3QoZnVuY3Rpb24oVHlwZTogc3RyaW5nLCAuLi4pCiAgICAgICAgbG9jYWwgQ2FsbGJhY2sgPSBzZWxmOkdldENvbW1DYWxsYmFjayhUeXBlKQogICAgICAgIGlmIENhbGxiYWNrIHRoZW4KICAgICAgICAgICAgQ2FsbGJhY2soLi4uKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIC0tLy8gQWRkIGRlZmF1bHQgY29tbXVuaWNhdGlvbiBjYWxsYmFja3MKICAgIHNlbGY6QWRkRGVmYXVsdENhbGxiYWNrcyhFdmVudCkKCiAgICByZXR1cm4gQ2hhbm5lbElELCBFdmVudAplbmQKCk1vZHVsZTpNYWtlRGVidWdJZEhhbmRsZXIoKQoKcmV0dXJuIE1vZHVsZQ=="}
}

local Players: Players = Services.Players

local Modules = Files:LoadLibraries(Scripts)
local Process = Modules.Process
local Hook = Modules.Hook
local Ui = Modules.Ui
local Generation = Modules.Generation
local Communication = Modules.Communication
local Config = Modules.Config

local FontContent = Files:GetAsset("ProggyClean.ttf", true)
local FontJsonFile = Files:CreateFont("ProggyClean", FontContent)
Ui:SetFontFile(FontJsonFile)

Process:CheckConfig(Config)
Files:LoadModules(Modules, {
	Modules = Modules,
	Services = Services
})

local Window = Ui:CreateMainWindow()

local Supported = Process:CheckIsSupported()
if not Supported then 
	Window:Close()
	return
end

local ChannelId, Event = Communication:CreateChannel()
Communication:AddCommCallback("QueueLog", function(...)
	Ui:QueueLog(...)
end)

local LocalPlayer = Players.LocalPlayer
Generation:SetSwapsCallback(function(self)
	self:AddSwap(LocalPlayer, {
		String = "LocalPlayer",
	})
	self:AddSwap(LocalPlayer.Character, {
		String = "Character",
		NextParent = LocalPlayer
	})
end)

Ui:CreateWindowContent(Window)
Ui:SetCommChannel(Event)
Ui:BeginLogService()

local ActorCode = Files:MakeActorScript(Scripts, ChannelId)
Hook:LoadHooks(ActorCode, ChannelId)
